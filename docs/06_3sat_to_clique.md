## 6. Редукция 3SAT $\le_m^p$ CLIQUE (доказательство + проверка на малых случаях)

**Задача CLIQUE (decision).** Вход: неориентированный граф $G=(V,E)$ и число $k$. Вопрос: существует ли клика размера $\ge k$?

**Lean‑скелет:** CNF/3CNF/SAT в `formal/PvNP/Core/SAT.lean`, базовый граф и клика — `formal/PvNP/Core/Graph.lean`, определение 3SAT→CLIQUE — `formal/PvNP/Core/ReductionsSAT.lean`.
Корректность — цель для формализации в Lean (пока не доказана в `formal/`).

**Теорема 6.1.** 3SAT $\le_m^p$ CLIQUE.

*Конструкция.* Пусть 3CNF‑формула $\varphi$ имеет $m$ клауз $C_1,\dots,C_m$, каждая — дизъюнкт из трёх литералов. Строим граф $G$:

- Вершины: по одной вершине на каждый литерал в каждой клаузе, т.е. $v_{i,\ell}$ для $\ell\in C_i$.
- Рёбра: соединяем $v_{i,\ell}$ и $v_{j,\ell'}$ (где $i\ne j$)
  тогда и только тогда, когда литералы **совместимы**: не являются
  взаимоисключающими, т.е. не имеют вид $x$ и $\neg x$ для одной переменной.

Выход: пара $(G,k)$ где $k=m$.

*Корректность.*

- Если $\varphi$ выполнима, выберем в каждой клаузе истинный литерал $\ell_i$.
  Эти литералы совместимы (иначе присваивание делало бы один из них ложным).
  Тогда для любых $i\ne j$ вершины $v_{i,\ell_i}$ и $v_{j,\ell_j}$ соединены;
  получаем клику из $m$ вершин.

- Если в $G$ есть клика размера $m$, то она берёт по одной вершине из каждой группы
  $\{v_{i,\ell}:\ell\in C_i\}$ (внутри клаузы рёбер нет), т.е. выбирает $\ell_i$.
  Совместимость всех пар означает отсутствие пары вида $x$ и $\neg x$.
  Построим присваивание, согласованное с выбранными литералами (остальные — произвольно).
  Тогда каждый $C_i$ удовлетворён выбранным $\ell_i$, значит удовлетворена вся формула.

*Сложность.* Граф имеет $3m$ вершин и $O(m^2)$ потенциальных рёбер; построение занимает полиномиальное время.

$\square$

**Лемма 6.2.** 3SAT $\in\mathrm{NP}$.


*Доказательство.* Сертификат — присваивание булевых значений переменным.
Верификатор за время $O(|\varphi|)$ проверяет истинность каждой клаузы.
$\square$


**Следствие 6.3.** Если SAT NP‑полна (Cook–Levin), то 3SAT NP‑полна.

*Доказательство.* Из Теоремы 5.1 имеем SAT $\le_m^p$ 3SAT.
Так как 3SAT $\in\mathrm{NP}$, то 3SAT NP‑трудна и принадлежит NP,
значит NP‑полна. $\square$

**Лемма 6.4.** CLIQUE $\in\mathrm{NP}$.

*Доказательство.* Сертификат — список из $k$ вершин.
Верификатор проверяет за $O(k^2)$, что все пары соединены ребром.
$\square$

**Следствие 6.5.** CLIQUE NP‑полна.

*Доказательство.* По Теореме 6.1 имеем 3SAT $\le_m^p$ CLIQUE.
По Следствию 6.3 задача 3SAT NP‑полна. С Леммой 6.4 (CLIQUE $\in\mathrm{NP}$)
получаем NP‑полноту CLIQUE. $\square$
