# P vs NP — исследовательские шаги 16.85–16.128 (Tseitin / proof complexity)

Этот файл — часть `docs/research/` (см. [index](index.md)).
Главный файл: `P_vs_NP.md`.

[Открыть главный ноутбук](../../P_vs_NP.md)

### 16.85. Исследовательский шаг: Tseitin($G,\chi$) и паритетный сертификат невыполнимости

- `Линза:` Инвариант.
- `Определение:` Пусть $G=(V,E)$ — неориентированный граф и $\chi:V\to\{0,1\}$
  («заряды»). Каждому ребру $e\in E$ сопоставим булеву переменную $x_e$.
  XOR‑система Tseitin задаётся уравнениями по модулю 2:
  $$\bigoplus_{e\ni v} x_e\ =\ \chi(v)\qquad\text{для всех }v\in V.$$
- `Утверждение:` Если для некоторой связной компоненты $H\subseteq G$ выполнено
  $\bigoplus_{v\in V(H)}\chi(v)=1$, то система (а значит и любая CNF/3‑CNF
  кодировка этих XOR‑ограничений) невыполнима.
- `Доказательство:` Возьмём XOR по всем вершинам $v\in V(H)$ от левых частей.
  Каждая переменная $x_e$ (для ребра $e$ внутри $H$) входит ровно дважды — по
  концам ребра — и потому сокращается: $\bigoplus_{v\in V(H)}\bigoplus_{e\ni v}x_e=0$.
  Тогда из уравнений следует $0=\bigoplus_{v\in V(H)}\chi(v)=1$, противоречие.
- `3‑CNF кодировка для 3‑регулярного $G$:` если $\deg(v)=3$ и инцидентные ребра
  имеют переменные $a,b,c$, то ограничение $a\oplus b\oplus c=\chi(v)$ эквивалентно
  3‑CNF из 4 клауз (запрещаем 4 несовпадающих по паритету тройки). Поэтому при
  3‑регулярном $G$ получаем 3‑CNF размера $4|V|$, и каждая переменная $x_e$ входит
  ровно в $8$ клауз (по $4$ у каждого конца ребра).
- `Toy‑тест:` одно ребро $e=\{u,v\}$ и $\chi(u)=1,\chi(v)=0$ даёт систему
  $x_e=1$ и $x_e=0$ (явная невыполнимость); паритетный аргумент выше ровно это
  фиксирует как $\chi(u)\oplus\chi(v)=1$.
- `Статус:` доказано (паритетный инвариант) + явная 3‑CNF для $\Delta=3$.
- `Барьер‑чек:` r — применимо (тривиально релятивизируется), NP — неприменимо
  (нет «natural property»), alg — неприменимо.
- `Следующий шаг:` зафиксировать в основном тексте, что это даёт семейство
  невыполнимых 3‑CNF с bounded‑occ на 3‑регулярных экспандерах, и привязать
  к известным резолюционным нижним оценкам (через экспансию/ширину).

### 16.86. Исследовательский шаг: экспансия ⇒ ширина/размер резолюции для Tseitin на bounded‑degree графах

- `Линза:` Трейд‑офф.
- `Утверждение:` Пусть $G=(V,E)$ — связный граф максимальной степени $\le k$, а
  $e(G):=\min_{A\subseteq V,\ |V|/3\le |A|\le 2|V|/3}|E(A,\bar A)|$ — его экспансия
  (Itsykson–Oparin 2013, Def. 2). Если Tseitin($G,\chi$) невыполнима, то ширина
  резолюционного опровержения удовлетворяет $W(\mathrm{Tseitin}(G,\chi)\vdash 0)\ge e(G)-1$
  (Itsykson–Oparin 2013, Cor. 1). Тогда по trade‑off “width ⇒ size”
  (Ben‑Sasson–Wigderson 2001; также сформулировано как Thm. 1 в Itsykson–Oparin 2013)
  получаем для числа переменных $n:=|E|$:
  $$S(\mathrm{Tseitin}(G,\chi))\ \ge\ \exp\!\left(\frac{(e(G)-k-1)^2}{n}\right),\qquad
    ST(\mathrm{Tseitin}(G,\chi))\ \ge\ 2^{\,e(G)-k-1}.$$
  В частности, для семейства графов степени $O(1)$ с $e(G)=\Omega(|V|)$ (экспандеры)
  имеем $n=\Theta(|V|)$ и потому $S\ge \exp(\Omega(|V|))$.
- `Toy‑тест:` цикл $C_n$ имеет $e(C_n)=2$, значит оценка даёт лишь константную
  нижнюю границу на ширину/размер; это согласуется с тем, что “плохая” экспансия
  не должна давать сильных нижних оценок.
- `Статус:` доказано (цитата Cor. 1 + стандартный width–size trade‑off).
- `Барьер‑чек:` r — неприменимо (модель‑специфическая нижняя оценка),
  NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` применить к 3‑регулярным экспандерам и 3‑CNF кодировке из §16.85,
  чтобы получить явное семейство bounded‑occ 3‑CNF с экспоненциальной резолюцией.

### 16.87. Исследовательский шаг: явное bounded‑occ Tseitin‑семейство на 3‑регулярных экспандерах

- `Линза:` Эквивалентность.
- `Утверждение:` Существует сильно‑явное семейство 3‑регулярных экспандеров
  $\{G_n\}$ с $\lambda(G_n)\le \lambda_0<1$ (например, семейство Ramanujan‑графов;
  см. обсуждение в `../../resources/downloads/arora_barak.pdf`, §16.3, Remark 16.10).
  Тогда по связи спектральной и комбинаторной экспансии (Arora–Barak, Thm. 16.18)
  имеем $|E(A,\bar A)|\ge \rho d|A|$ для всех $|A|\le |V|/2$ и некоторой константы
  $\rho>0$, откуда $e(G_n)=\Omega(|V_n|)$ в смысле Def. 2 из Itsykson–Oparin.
  Пусть $\chi_n$
  имеет нечётную сумму зарядов, и $F_n$ — 3‑CNF кодировка Tseitin($G_n,\chi_n$) из §16.85.
  Тогда:
  (i) $F_n$ невыполнима; (ii) $|F_n|=\Theta(|V_n|)$; (iii) bounded‑occ = 8;
  (iv) размер резолюционного опровержения $S(F_n)=\exp(\Omega(|V_n|))$ (по §16.86).
- `Toy‑тест:` если $G$ — цикл, то $e(G)=2$ и §16.86 даёт лишь константные границы;
  на экспандере $e(G)=\Omega(|V|)$ и при $|E|=\Theta(|V|)$ получаем экспоненту
  $\Omega(|V|)$ в нижней оценке на $S(F)$.
- `Статус:` доказано (композиция 16.85 + 16.86 + существование expander family).
- `Барьер‑чек:` r — неприменимо (модель‑специфическая нижняя оценка),
  NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` уточнить/зафиксировать конкретную ссылку на выбранную явную
  3‑регулярную expander family (по необходимости) и отметить, какие системы
  доказательств (PC/EF) остаются открытыми на этих формулах.

### 16.88. Исследовательский шаг: Tseitin легко в EF; PC зависит от поля/базиса

- `Линза:` Алгебраизация.
- `Утверждение:` Пусть $G$ связен и $\bigoplus_{v\in V}\chi(v)=1$. Тогда 3‑CNF
  кодировка $F=\mathrm{TseitinCNF}(G,\chi)$ из §16.85 имеет полиномиальное
  опровержение в Extended Frege (EF), так как
  противоречие даёт суммирование XOR‑уравнений по модулю 2. Для Polynomial
  Calculus: над полем характеристики 2 соответствующая линейная система
  опровергается в степени 1; над $\mathrm{char}(F)\ne 2$ в Fourier‑базисе известны
  линейные degree‑нижние оценки (Beame–Sabharwal 2000, Thm. 2.18).
- `Доказательство (EF‑каркас):`
  Обозначим $a\oplus b := (a\wedge\neg b)\vee(\neg a\wedge b)$.
  Тождества ассоциативности/коммутативности и сокращения
  $a\oplus(a\oplus b)\leftrightarrow b$, $a\oplus a\leftrightarrow 0$
  имеют константный размер (3 переменные) ⇒ константные Frege‑выводы.
  Для каждой вершины $v$ степени 3, с инцидентными рёбрами $e_1,e_2,e_3$,
  4 клаузы из §16.85 эквивалентны формуле
  $$(x_{e_1}\oplus x_{e_2}\oplus x_{e_3})\leftrightarrow \chi(v)$$
  (проверка 8 значений; константный вывод).
  В EF введём extension‑переменные $p_v\leftrightarrow (x_{e_1}\oplus x_{e_2}\oplus x_{e_3})$
  и $P\leftrightarrow\bigoplus_{v\in V} p_v$ (цепочка/дерево XOR, размер $O(|V|)$).
  Из предыдущего получаем $P\leftrightarrow\bigoplus_v\chi(v)$, а значит $P$.
  С другой стороны, подставляя определения $p_v$ и используя локальные
  перестановки/скобки XOR (полиномиально много шагов), получаем
  $$P\leftrightarrow\bigoplus_{v\in V}\ \bigoplus_{e\ni v} x_e\ \leftrightarrow\ \bigoplus_{e\in E}(x_e\oplus x_e)\ \leftrightarrow\ 0,$$
  противоречие.
- `Ссылка (EF ⊢ XOR/Gauss):` отмечено, что EF «легко симулирует Gaussian elimination»
  (и потому полиномиально доказывает линейно‑алгебраические утверждения),
  см. Bonet–Buss–Pitassi 2002, `../../resources/downloads/bonet_buss_pitassi_2002_hard_examples_frege.pdf` (p. 7).
- `PC‑заметка:` Если рассматривать Tseitin как линейную систему над $\mathbb F_2$,
  $$\sum_{e\ni v} x_e = \chi(v)\quad(\bmod 2),$$
  то в PC над $\mathbb F_2$ опровержение получается в степени 1: суммируем
  уравнения по $v\in V$, получаем $0=\bigoplus_v\chi(v)=1$.
- `Известный факт (PC, $\mathrm{char}(F)\ne 2$):` для любой последовательности bounded‑degree
  графов $\{G_n\}$ с $c(G_n)=\Omega(1)$ (экспандеры) любая PC‑рефутация
  $\mathrm{Tseitin}(G_n)$ над полем нечётной или нулевой характеристики имеет степень
  $\Omega(|V_n|)$, а по связи degree→size также размер $\exp(\Omega(|V_n|))$
  (Razborov 2023, Thm. 6.8 + абзац после Thm. 6.9).
- `Toy‑тест:` $G=C_3$ и $\chi\equiv 1$. Сумма трёх уравнений даёт
  $(x_{12}\oplus x_{12})\oplus(x_{23}\oplus x_{23})\oplus(x_{31}\oplus x_{31})=1$,
  то есть $0=1$.
- `Статус:` EF‑верхняя оценка — доказано как схема; для PC над $\mathbb F_2$ — доказано;
  для $\mathrm{char}(F)\ne 2$ степень и размер — известные нижние оценки (см. факт выше).
- `Барьер‑чек:` r — неприменимо (утверждение про конкретные proof‑системы),
  NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` см. §16.89 (клаузная форма TseitinCNF легко в PC над $\mathbb F_2$);
  дальше — понять, переносится ли (и как) degree‑LB для $\mathrm{char}(F)\ne 2$ с XOR‑системы
  на 3‑CNF кодировку.

### 16.89. Исследовательский шаг: TseitinCNF легко в PC над $\mathbb F_2$ (степень 3)

- `Линза:` Эквивалентность.
- `Утверждение:` Пусть $G$ — 3‑регулярный граф, $\chi:V\to\{0,1\}$ и
  $\bigoplus_{v\in V}\chi(v)=1$. Пусть $F=\mathrm{TseitinCNF}(G,\chi)$ — 3‑CNF из §16.85.
  Тогда над полем $\mathbb F_2$ существует Polynomial Calculus‑рефутация $F$ степени $\le 3$
  и размера $O(|V|)$.
- `Доказательство (локальная линейная форма):`
  Переводим клаузу $(\ell_1\vee \ell_2\vee \ell_3)$ в полиномиальное уравнение
  $$(1-\ell_1)(1-\ell_2)(1-\ell_3)=0,$$
  где литерал $\neg x$ интерпретируется как $1-x$ (булевы аксиомы $x^2-x=0$ не нужны).
  Зафиксируем вершину $v$ степени 3 с инцидентными рёбрами $e_1,e_2,e_3$ и обозначим
  $x_i:=x_{e_i}$.
  - Если $\chi(v)=1$, то 4 клаузы из §16.85 дают 4 аксиомы:
    $$(1-x_1)(1-x_2)(1-x_3)=0,\ (1-x_1)x_2x_3=0,\ x_1(1-x_2)x_3=0,\ x_1x_2(1-x_3)=0.$$
    Складывая их в $\mathbb F_2$, получаем $1+x_1+x_2+x_3=0$, то есть $x_1+x_2+x_3+\chi(v)=0$.
  - Если $\chi(v)=0$, то аналогично из 4 клауз получаем аксиомы:
    $$(1-x_1)(1-x_2)x_3=0,\ (1-x_1)x_2(1-x_3)=0,\ x_1(1-x_2)(1-x_3)=0,\ x_1x_2x_3=0,$$
    и их сумма равна $x_1+x_2+x_3=0$, то есть снова $x_1+x_2+x_3+\chi(v)=0$.

  Итак, для каждого $v$ выводится линейное уравнение
  $$\sum_{e\ni v} x_e\ +\ \chi(v)\ =\ 0\quad(\text{в }\mathbb F_2).$$
  Складывая эти уравнения по всем $v\in V$, получаем
  $$\sum_{v\in V}\sum_{e\ni v}x_e\ +\ \sum_{v\in V}\chi(v)=0.$$
  Каждая переменная $x_e$ входит в левую часть ровно дважды (по концам ребра), значит
  в $\mathbb F_2$ сокращается, и остаётся $\sum_v\chi(v)=0$, то есть $1=0$ — противоречие.
  Степень доказательства $\le 3$ (все клаузные аксиомы степени 3), число строк $O(|V|)$.
- `Toy‑тест:` $G=C_3$ и $\chi\equiv 1$. Для каждой вершины выводится линейное уравнение
  по трём рёбрам, сумма трёх уравнений даёт $1=0$.
- `Статус:` доказано (явный локальный вывод + суммирование по графу).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` сформулировать такой же «локальный перевод» для $\mathrm{char}(F)\ne 2$
  (или найти ссылку), чтобы связать TseitinCNF с известными degree‑LB для PC.

### 16.90. Исследовательский шаг: TseitinCNF $\leftrightarrow$ биномиальная Tseitin в PC при $\mathrm{char}(F)\ne 2$

- `Линза:` Эквивалентность.
- `Утверждение:` Пусть $F$ — поле, $\mathrm{char}(F)\ne 2$, и $v$ — вершина степени 3
  с инцидентными переменными $x_1,x_2,x_3\in\{0,1\}$ и зарядом $\chi\in\{0,1\}$.
  Пусть 4 клаузы TseitinCNF($v$) — стандартная 3‑CNF кодировка ограничения
  $x_1\oplus x_2\oplus x_3=\chi$ (как в §16.85), переведённая в PC‑аксиомы вида
  $(1-\ell_1)(1-\ell_2)(1-\ell_3)=0$. Тогда:
  1) из этих 4 клауз в PC выводится одно уравнение степени 3
     $$X(x_1,x_2,x_3)-\chi=0,$$
     где
     $$X(x_1,x_2,x_3):=x_1+x_2+x_3-2(x_1x_2+x_1x_3+x_2x_3)+4x_1x_2x_3;$$
  2) при линейной замене $y_i:=1-2x_i$ это эквивалентно биномиальному уравнению
     $$y_1y_2y_3-(1-2\chi)=0\quad(\text{и }y_i^2-1=0);$$
  3) наоборот, из $X-\chi=0$ в PC выводятся все 4 клаузные аксиомы с константной
     потерей степени (≤6). Следовательно, для 3‑регулярных графов TseitinCNF и
     «биномиальная» Tseitin (Fourier/±1‑база) p‑эквивалентны по степени в PC.
     В частности, degree/size‑нижние оценки для биномиальной Tseitin при $\mathrm{char}(F)\ne 2$
     (Razborov 2023, Thm. 6.8; см. также Beame–Sabharwal 2000, Thm. 2.18) переносятся на TseitinCNF.

- `Доказательство (1, локально):`
  В $\mathbb F[x_1,x_2,x_3]/(x_i^2-x_i)$ каждая клаузная аксиома для вершины степени 3 —
  это индикатор запрещённого присваивания (моном степени 3 в литералах $x_i$ и $(1-x_i)$).
  Для $\chi=0$ запрещены 4 нечётные тройки, и сумма 4 индикаторов равна ровно $X$.
  Для $\chi=1$ запрещены 4 чётные тройки, и сумма индикаторов равна $1-X$.
  В обоих случаях из 4 равенств “индикатор = 0” выводится $X-\chi=0$
  (для $\chi=1$ умножением на $-1$).

- `Доказательство (2):`
  Раскрывая скобки,
  $$(1-2x_1)(1-2x_2)(1-2x_3)=1-2X(x_1,x_2,x_3).$$
  Поэтому
  $$y_1y_2y_3-(1-2\chi)=(1-2X)-(1-2\chi)=-2(X-\chi),$$
  то есть уравнения отличаются на ненулевой скаляр.

- `Доказательство (3, локально):`
  Пусть $m_{a_1a_2a_3}:=\prod_i (x_i)^{a_i}(1-x_i)^{1-a_i}$ — индикатор присваивания $(a_1,a_2,a_3)$.
  Если $(a_1\oplus a_2\oplus a_3)\ne\chi$, то на этом присваивании $X-\chi=\pm 1$, а на остальных
  $m_{a_1a_2a_3}=0$, значит в фактор‑алгебре тождественно
  $$(X-\chi)\,m_{a_1a_2a_3}=\pm m_{a_1a_2a_3}.$$
  Из $X-\chi=0$ по правилу умножения получаем $(X-\chi)m_{a_1a_2a_3}=0$, откуда $m_{a_1a_2a_3}=0$.
  Это ровно одна из 4 клауз TseitinCNF($v$). Степень: $\deg(X-\chi)\le 3$, $\deg(m)\le 3$, итого ≤6.

- `Toy‑тест:` $\chi=1$. Сумма 4 «чётных» индикаторов (000,011,101,110) равна $1-X$,
  значит из них следует $X-1=0$, а затем и $y_1y_2y_3+1=0$.
- `Статус:` доказано (локальная p‑эквивалентность по степени при $\mathrm{char}(F)\ne 2$).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` если нужно для основного текста, добавить 1‑строчную ремарку в 15.x:
  «при $\mathrm{char}(F)\ne 2$ TseitinCNF наследует PC degree/size‑LB через 16.90».

### 16.91. Исследовательский шаг: Tseitin имеет полиномиальные Frege‑опровержения (Urquhart 1987)

- `Линза:` Эквивалентность.
- `Утверждение:` Пусть $G$ связен и $\bigoplus_{v\in V}\chi(v)=1$; пусть $\mathrm{TseitinCNF}(G,\chi)$ — клаузная
  форма уравнений по модулю 2 (как в §16.85 для $\deg(G)=3$, или в общем виде через $2^{\deg(v)-1}$ клауз на вершину).
  Тогда $\mathrm{TseitinCNF}(G,\chi)$ имеет полиномиальное опровержение в обычном Frege (в частности,
  в «Kleene’s axiomatic system», т.е. Hilbert‑style propositional calculus): Urquhart (1987) даёт
  явный вывод длины $O(n^4)$ (где $n=\Theta(|V|)$ при bounded‑degree).
- `Доказательство (идея из Urquhart 1987, Lemma 6.1):`
  1) для каждой вершины $v$ из клаузы‑кодировки восстанавливается соответствующее XOR‑уравнение
     (у Urquhart — «biconditional»/эквивалентность, фиксирующая чётность литералов у вершины);
  2) эти эквивалентности «склеиваются» в одно большое выражение; затем с помощью
     ассоциативности/коммутативности «всплывают» парные вхождения переменных и сокращаются;
  3) остаётся противоречие, так как левая часть сокращается в $0$, а правая даёт
     $\bigoplus_v\chi(v)=1$.
  Подробности: Urquhart 1987, §6, Lemma 6.1, `../../resources/downloads/urquhart_1987_hard_examples_resolution.pdf`.
- `Toy‑тест:` $G=C_3$, $\chi\equiv 1$: три локальные XOR‑уравнения суммируются в $0=1$
  (см. также toy‑тест в §16.88).
- `Статус:` доказано (верхняя оценка/ссылка).
- `Барьер‑чек:` r — неприменимо (это верхняя оценка в фиксированной модели доказательств),
  NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` уточнить «минимальную глубину» полиномиальных Frege‑опровержений Tseitin:
  зафиксировать лучшую известную depth‑vs‑size оценку (ссылка на работу уровня Håstad’17/18 и/или последующие усиления).

### 16.92. Исследовательский шаг: depth‑vs‑size для Tseitin(Grid) в bounded‑depth Frege (Håstad 2020)

- `Линза:` Трейд‑офф.
- `Утверждение:` Рассмотрим Tseitin‑противоречие на $n\times n$ решётке (grid).
  Если $d\le \frac{\log n}{59\log\log n}$, то любая depth‑$d$ Frege‑рефутация имеет размер
  $\exp(\Omega(n^{1/(58(d+1))}))$ (Håstad 2020, Thm. 6.5; `../../resources/downloads/hastad_2020_small_depth_frege_tseitin_grids.pdf`).
  В частности, любая полиномиальная
  по $n$ (а значит и по числу переменных $N=\Theta(n^2)$) Frege‑рефутация требует формул глубины
  $\Omega(\log n/\log\log n)$ (Håstad 2020, Cor. 6.6).
- `Toy‑тест:` при константной глубине $d=O(1)$ получаем superpolynomial нижнюю оценку
  $\exp(\Omega(n^{\Omega(1)}))=\exp(\Omega(N^{\Omega(1)}))$ для Tseitin(Grid$_{n,n}$).
- `Статус:` известный факт (точная ссылка).
- `Барьер‑чек:` r — неприменимо (нижняя оценка для ограниченной модели доказательств),
  NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` сопоставить с «верхней» оценкой $O(\log n)$ глубины для poly‑size Frege‑рефутаций Tseitin
  (Buss‑style счёт/паритет) и зафиксировать, насколько tight остаётся разрыв $O(\log\log n)$.

### 16.93. Исследовательский шаг: верхняя оценка $O(\log n)$ глубины для poly‑size Frege на Tseitin (bounded‑degree)

- `Линза:` Сжатие/канонизация.
- `Утверждение:` Для Tseitin‑противоречия на любом bounded‑degree графе (клаузная форма паритетных уравнений)
  существует полиномиальный по $n$ Frege‑вывод, использующий формулы глубины $O(\log n)$ в стандартном языке
  $L_\\in=\\{\\wedge,\\vee,\\neg\\}$.
- `Доказательство:` берём polynomial‑size Frege‑опровержение $\\pi$ из Urquhart (1987) (см. §16.91).
  Затем применяем к каждой линии $A$ из $\\pi$ Spira‑балансировку (Bonet–Buss 2002, Thm. 2; см. §16.94),
  получая эквивалентную формулу $A'$ глубины $O(\\log|A|)$ и размера $\\mathrm{poly}(|A|)$.
  По §16.114 для этой балансировки существуют polynomial‑size Frege‑доказательства тавтологий $A\\leftrightarrow A'$,
  а по §16.113 из $A$ и $A\\leftrightarrow A'$ выводится $A'$ с $O(1)$ дополнительными строками.
  Заменяя линии по индукции, получаем Frege‑опровержение $\\pi'$ той же CNF, где все линии имеют глубину $O(\\log n)$,
  а общий blow‑up остаётся полиномиальным (так как исходный размер $\\pi$ полиномиален по $n=\\Theta(|\\mathrm{TseitinCNF}(G,\\chi)|)$ при bounded‑degree).
- `Toy‑тест:` на цикле можно выписать balanced‑формулу для XOR всех уравнений и сократить парные вхождения рёбер,
  получая $0=1$ при нечётной сумме зарядов.
- `Статус:` доказано (через §16.91+§16.94+§16.113–§16.114).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` проверить, даёт ли верхняя оценка из 16.97 (GIRS’19, Thm. 19) polynomial‑size уже при глубине
  $\\Theta(\\log n/\\log\\log n)$ на решётках/экспандерах, и тем самым закрывает разрыв с 16.92.

### 16.94. Исследовательский шаг: балансовка формул ⇒ можно требовать глубину $O(\log n)$ в Frege

- `Линза:` Трейд‑офф.
- `Утверждение:` Любая булева формула размера $m$ эквивалентна формуле глубины $O(\log m)$
  (Brent/Spira restructuring). Точная ссылка: Bonet–Buss (2002), Theorem 2 (Spira),
  `../../resources/downloads/bonet_buss_2002_size_depth_tradeoffs_boolean_formulae.pdf`.
  Следовательно, если $\mathrm{TseitinCNF}(G,\chi)$ имеет polynomial‑size Frege‑рефутацию
  (16.91, Urquhart 1987), то можно считать, что все большие промежуточные формулы
  в этой рефутации сбалансированы до глубины $O(\log n)$ (с полиномиальным blow‑up),
  т.е. верхняя оценка $O(\log n)$ по глубине не требует отдельной «счётной» конструкции.
- `Toy‑тест:` длинная цепочка дизъюнкций/биимпликаций длины $m$ имеет глубину $\Theta(m)$,
  но после балансировки становится глубины $O(\log m)$.
- `Статус:` доказано (замена линий: §16.113; p‑доказательства эквивалентности для Spira‑балансировки: §16.114).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` использовать 16.94+16.95 как «чистую» верхнюю оценку по глубине и возвращаться к нижним оценкам (16.92, 16.97).

### 16.95. Исследовательский шаг: Urquhart‑Tseitin + Spira‑перевод ⇒ $O(\log n)$‑depth Frege (строго)

- `Линза:` Эквивалентность.
- `Утверждение:` Пусть есть Frege‑опровержение формулы $\Phi$ в языке $L_\infty$, где в частности разрешены
  $\{\wedge,\oplus,\neg\}$ или $\{\equiv,\oplus\}$ (как в Urquhart 1987 для «biconditionals»).
  Тогда существует полиномиально по размеру доказательства Frege‑опровержение $\Phi'$ в стандартном языке
  $L_\in=\{\wedge,\vee,\neg\}$, причём перевод $\phi\mapsto\phi'$ устроен так, что:
  (i) $\phi'$ эквивалентна $\phi$ (по смыслу); (ii) глубина $\phi'$ равна $O(\log|\phi|)$ (Spira‑rebalancing);
  (iii) размер $\phi'$ полиномиален в $|\phi|$. Ссылка: Buss (1997), Theorem 3 + доказательство‑эскиз
  «indirect translation via Spira», `../../resources/downloads/buss_1997_proof_complexity_intro.pdf`.
  Следствие: для bounded‑degree $\mathrm{TseitinCNF}(G,\chi)$ (нечётная сумма зарядов) существует
  polynomial‑size Frege‑опровержение, использующее формулы глубины $O(\log n)$: берём
  Urquhart (1987) (16.91) и применяем перевод Buss’97/Spira.
- `Toy‑тест:` если делать «прямой перевод» $\phi_1\oplus\phi_2\mapsto(\phi_1\wedge\neg\phi_2)\vee(\neg\phi_1\wedge\phi_2)$
  рекурсивно по линейной глубине, то размер может стать экспоненциальным; Spira‑перевод
  «ре‑балансирует» дерево и держит размер полиномиальным (Buss’97, Proof sketch к Thm. 3).
- `Статус:` известный факт (закрыта техническая часть для 16.94/вопроса Q14).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` использовать это как «чистое» обоснование верхней оценки $O(\log n)$ по глубине и
  дальше улучшать нижние оценки (сужать разрыв с 16.92).

### 16.96. Исследовательский шаг: Tseitin на экспандерах — depth‑vs‑size (Pitassi–Rossman–Servedio–Tan 2016)

- `Линза:` Трейд‑офф.
- `Утверждение:` Существует линейного размера 3‑CNF‑противоречие $\mathrm{Tseitin}(G_n[\alpha])$
  на 3‑регулярном $n$‑вершинном экспандере, такое что для любого $d$ любая depth‑$d$ Frege‑рефутация
  имеет размер $n^{\Omega((\log n)/d^2)}$ (Pitassi–Rossman–Servedio–Tan 2016, Thm. 1,
  `../../resources/downloads/pitassi_rossman_servedio_tan_2016_expander_switching_lemma.pdf`).
  Следовательно, любая polynomial‑size Frege‑рефутация требует глубины $d=\Omega(\sqrt{\log n})$.
- `Toy‑тест:` если $d=O(1)$, то нижняя оценка даёт размер $\exp(\Omega((\log n)^2))=n^{\Omega(\log n)}$ (quasi‑poly),
  а если $d=\Theta(\sqrt{\log n})$, то показатель $(\log n)/d^2=\Theta(1)$ и оценка перестаёт быть superpolynomial.
- `Статус:` известный факт (точная ссылка).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` сопоставить 16.96 (экспандер: $\sqrt{\log n}$) с 16.92 (grid: $\log n/\log\log n$)
  и понять, где именно “теряется” $\sqrt{\log n}\to\log n/\log\log n$ в технике ограничений.

### 16.97. Исследовательский шаг: treewidth даёт tight depth‑vs‑size для Tseitin в bounded‑depth Frege (Galesi–Itsykson–Riazanov–Sofronova 2019)

- `Линза:` Трейд‑офф.
- `Утверждение:` Пусть $G$ — связный неориентированный граф на $n$ вершинах, $t=\mathrm{tw}(G)$, и $\mathrm{Tseitin}(G,f)$ невыполнима.
  Тогда существуют константы $K,C>0$ такие, что для любого $d\le K\log n/\log\log n - C$ любая depth‑$d$ Frege‑рефутация
  имеет размер $\ge 2^{t^{\Omega(1/d)}}$ (Galesi–Itsykson–Riazanov–Sofronova 2019, Thm. 18,
  `../../resources/downloads/galesi_itsykson_riazanov_sofronova_2019_bounded_depth_frege_tseitin_all_graphs.pdf`).
  Более того, для всех достаточно больших $d$ существует depth‑$d$ Frege‑рефутация размера $\le 2^{t^{O(1/d)}}\cdot\mathrm{poly}(|\mathrm{Tseitin}(G,f)|)$
  (там же, Thm. 19).
- `Toy‑тест:` если $\mathrm{tw}(G)=\Omega(n)$ (в частности, для bounded‑degree экспандеров, как отмечено в той же работе),
  то polynomial‑size ($n^{O(1)}$) возможно только при $d=\Omega(\log n/\log\log n)$; с другой стороны,
  при $d=\Theta(\log n/\log\log n)$ с достаточно большим константным коэффициентом верхняя оценка Thm. 19
  уже даёт polynomial‑size (см. явный расчёт в §16.115), т.е. порог по глубине на таких графах совпадает с grid‑случаем (16.92)
  по порядку и усиливает PRST’16 (16.96).
- `Статус:` известный факт (точная ссылка; закрывает «усиление для экспандеров/всех графов» из Q15).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` если понадобится связать с «поиском доказательств», извлечь Cor. 34 из той же работы:
  bounded‑depth Frege размера $S$ ⇒ tree‑like Resolution размера $2^{\mathrm{poly}(\log S)}$.

### 16.98. Исследовательский шаг: bounded‑depth Frege ⇒ tree‑like Resolution (quasi‑poly) для Tseitin (GIRS 2019, Cor. 34)

- `Линза:` Эквивалентность.
- `Утверждение:` Для любой невыполнимой Tseitin‑CNF $\mathrm{Tseitin}(G,f)$: если она имеет доказательство размера $S$
  в bounded‑depth Frege (в смысле статьи; ниже упоминается «constant‑depth Frege»), то она имеет tree‑like Resolution‑опровержение
  размера $\le 2^{\mathrm{poly}(\log S)}$ (Galesi–Itsykson–Riazanov–Sofronova 2019, Cor. 34,
  `../../resources/downloads/galesi_itsykson_riazanov_sofronova_2019_bounded_depth_frege_tseitin_all_graphs.pdf`).
- `Доказательство (эскиз из §5 той же работы):` там используется (i) верхняя оценка на tree‑like Resolution через ширину:
  по §16.99 (Beame–Beck–Impagliazzo 2016, Lemma 61) имеем $\mathrm{size}_{\mathrm{TL\text{-}Res}}\le n^{O(\mathrm{cw}(G))}$;
  по §16.100–16.101 (и определению $w(G):=W(T(G,\\varphi)\\vdash\\bot)-1$) получаем $\mathrm{cw}(G)\le w(G)+2$, значит
  $\mathrm{size}_{\mathrm{TL\text{-}Res}}(T(G,\\varphi))\le n^{O(w(G))}=2^{O(\mathrm{tw}(G)\,\Delta(G)\,\log n)}$
  (Harvey–Wood 2014, (2); см. §16.102); (ii) нижняя оценка из главной теоремы для bounded‑depth Frege: $S\ge 2^{\mathrm{tw}(G)^{\varepsilon}}$
  для некоторой константы $\varepsilon>0$ (глубина фиксирована); (iii) тривиально $S\ge|\mathrm{Tseitin}(G,f)|\ge 2^{\Delta(G)-1}$ и $S\ge n$.
  Отсюда $\mathrm{tw}(G)\le (\log S)^{1/\varepsilon}$, $\Delta(G)\le O(\log S)$ и $\log n\le O(\log S)$, и подстановка в (i)
  даёт $2^{O((\log S)^{1/\varepsilon+2})}=2^{\mathrm{poly}(\log S)}$.
- `Toy‑тест:` если $S=n^{O(1)}$, то получаем tree‑like Resolution размера $\le 2^{\mathrm{poly}(\log n)}=n^{\mathrm{polylog}\,n}$ (quasi‑poly).
- `Статус:` известный факт (точная формулировка + минимальный вывод «откуда берётся» $2^{\mathrm{poly}(\log S)}$).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` при необходимости перенести цепочку §16.99–16.102 (определение $w(G)$ и $n^{O(w(G))}$) в основной текст
  рядом с формулировкой Cor. 34, чтобы не ссылаться на «см. обсуждение».

### 16.99. Исследовательский шаг: tree‑like Resolution‑upper bound для Tseitin через carving width (Beame–Beck–Impagliazzo 2016)

- `Линза:` Трейд‑офф.
- `Утверждение:` Пусть $G$ — граф на $n$ вершинах с carving width $W$ (Definition 58). Тогда соответствующая
  Tseitin‑таутология $\tau(G)$ имеет tree‑like resolution‑рефутацию ранга $\le W\log_{3/2} n$; в частности,
  существует tree‑like resolution‑рефутация размера $\le n^{W(\log 3-1)}$ и clause space $\le W\log_{3/2} n+1$
  (Beame–Beck–Impagliazzo 2016, Lemma 61,
  `../../resources/downloads/beame_beck_impagliazzo_2016_time_space_tradeoffs_resolution.pdf`).
- `Toy‑тест:` при $W=O(1)$ получаем polynomial‑size tree‑like resolution для $\tau(G)$ (и глубину дерева $O(\log n)$);
  при каждом рекурсивном разрезе по (1/3,2/3)-лемме ранг увеличивается на $\le W$, а высота рекурсии равна $\log_{3/2} n$.
- `Статус:` известный факт (точная ссылка; закрывает «где именно берётся» tree‑like upper bound, т.е. компонент [3] в GIRS’19 Cor. 34).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` связать параметр $W$ (carving width) с $w(G)$ из GIRS’19 (минимальная resolution‑width для Tseitin)
  и выписать минимальную цепочку неравенств, нужную для $n^{O(w(G))}$.

### 16.100. Исследовательский шаг: carving width $\le \mathrm{tw}(L(G))+1$ (и значит $n^{O(W)}=n^{O(w(G))}$)

- `Линза:` Эквивалентность.
- `Утверждение:` Для любого графа $G$ выполнено $\mathrm{cw}(G)\le \mathrm{tw}(L(G))+1$, где $\mathrm{cw}$ — carving width,
  а $L(G)$ — line graph. Следовательно, используя формулу для Tseitin‑width
  $w(G)=\max\{\Delta(G),\mathrm{tw}(L(G))\}-1$ (Galesi–Talebanfard–Torán 2018, Cor. 8+16,
  `../../resources/downloads/galesi_talebanfard_toran_2018_cops_robber_tseitin.pdf`), получаем $\mathrm{cw}(G)\le w(G)+2$, и верхняя оценка
  из §16.99 вида $n^{O(\mathrm{cw}(G))}$ эквивалентна $n^{O(w(G))}$.
- `Доказательство:` Пусть $(T,\{B_t\})$ — tree decomposition графа $L(G)$ ширины $k=\mathrm{tw}(L(G))$,
  т.е. $|B_t|\le k+1$.
  Для вершины $v\in V(G)$ множество рёбер $E(v)$ образует клику в $L(G)$, значит (по свойству Helly для поддеревьев в $T$)
  существует узел $t_v\in V(T)$ такой, что $E(v)\subseteq B_{t_v}$.
  Добавим к $T$ лист $\ell_v$ с ребром $\ell_v t_v$ и положим $\chi(\ell_v)=v$; получаем carving‑дерево
  (при необходимости его можно сделать бинарным стандартным «раздвоением» узлов копиями того же bag — ширина не растёт).
  Рассмотрим ребро $xy$ этого дерева и индуцированный разрез $V(G)=A\sqcup B$ по листьям.
  Если $xy=\ell_v t_v$, то $|E(A,B)|=\deg(v)\le |B_{t_v}|\le k+1$.
  Иначе $xy$ соединяет два bag‑узла: если $uv\in E(A,B)$, то в $L(G)$ вершина $e=\{u,v\}$ лежит и в $B_{t_u}$, и в $B_{t_v}$,
  значит её множество появлений в tree decomposition — связное поддерево, содержащее путь $t_u\leadsto t_v$ и, в частности, ребро $xy$.
  Следовательно, $e\in B_x\cap B_y$, то есть $E(A,B)\subseteq B_x\cap B_y$ и $|E(A,B)|\le |B_x\cap B_y|\le k+1$.
  Значит ширина построенной carving‑декомпозиции $\le k+1$, т.е. $\mathrm{cw}(G)\le \mathrm{tw}(L(G))+1$.
- `Toy‑тест:` для цикла $C_n$: $\mathrm{tw}(L(C_n))=2$, поэтому $\mathrm{cw}(C_n)\le 3$ (на деле $\mathrm{cw}(C_n)=2$);
  для звезды $K_{1,n}$: $\mathrm{tw}(L)=n-1$ и $\mathrm{cw}(K_{1,n})=n=\mathrm{tw}(L)+1$.
- `Статус:` доказано.
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` теперь, когда первоисточник $w(G)=\max\{\Delta(G),\mathrm{tw}(L(G))\}-1$ зафиксирован (16.101),
  обновить цепочку в §16.98/Cor. 34: tree‑like upper bound $n^{O(\mathrm{cw}(G))}$ можно заменить на $n^{O(w(G))}$ без ссылочных дыр.

### 16.101. Исследовательский шаг: точная ссылка на $w(G)=\max\{\\Delta(G),\\mathrm{tw}(L(G))\\}-1$ для Tseitin‑width

- `Линза:` Эквивалентность.
- `Утверждение:` Пусть $G$ — связный граф, а $\\varphi$ — нечётная разметка (odd marking), так что Tseitin‑CNF $T(G,\\varphi)$ невыполнима.
  Тогда минимальная ширина резолюционного опровержения удовлетворяет
  $$W(T(G,\\varphi)\\vdash\\bot)=\\max\\{\\Delta(G),\\mathrm{tw}(L(G))\\},$$
  где $\\Delta(G)$ — максимальная степень, $L(G)$ — line graph. В обозначениях GIRS’19 (Cor. 33),
  где $w(G)=W(T(G,\\varphi)\\vdash\\bot)-1$, получаем
  $$w(G)=\\max\\{\\Delta(G),\\mathrm{tw}(L(G))\\}-1.$$
- `Доказательство (по источнику):` Galesi–Talebanfard–Torán (2018) доказывают (i) Cor. 8:
  $W(T(G,\\varphi)\\vdash\\bot)=\\max\\{\\Delta(G),\\mathrm{ec}(G)-1\\}$, и (ii) Cor. 16:
  $\\mathrm{ec}(G)=\\mathrm{tw}(L(G))+1$; подстановка даёт требуемую формулу.
  См. `../../resources/downloads/galesi_talebanfard_toran_2018_cops_robber_tseitin.pdf`.
- `Toy‑тест:` для звезды $K_{1,n}$ имеем $\\Delta=n$ и $L(G)=K_n$ с $\\mathrm{tw}(K_n)=n-1$,
  значит $W=\\max\\{n,n-1\\}=n$ (и $w=n-1$), что согласуется с тем, что начальные клаузы имеют ширину $n$.
  Для цикла $C_n$: $\\Delta=2$ и $L(C_n)=C_n$ с $\\mathrm{tw}=2$, поэтому $W=2$ (и $w=1$).
- `Статус:` известный факт (точная ссылка; закрывает Q19).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` сопоставить эту treewidth‑формулу с альтернативной параметризацией Tseitin‑width через branch‑width
  из Alekhnovich–Razborov (2011) (возможная замена $\\mathrm{tw}(L(G))$ на эквивалентную «ширину»).

### 16.102. Исследовательский шаг: $n^{O(w(G))}=2^{O(\\mathrm{tw}(G)\\,\\Delta(G)\\log n)}$ (через оценки на $\\mathrm{tw}(L(G))$)

- `Линза:` Трейд‑офф.
- `Утверждение:` Пусть $G$ — связный граф на $n$ вершинах и $\\varphi$ — нечётная разметка, так что Tseitin‑CNF $T(G,\\varphi)$ невыполнима.
  Обозначим $w(G):=W(T(G,\\varphi)\\vdash\\bot)-1$. Тогда
  $$n^{O(w(G))}=2^{O(\\mathrm{tw}(G)\\,\\Delta(G)\\log n)}.$$
- `Доказательство:` По §16.101 имеем $w(G)+1=\\max\\{\\Delta(G),\\mathrm{tw}(L(G))\\}$.
  По Harvey–Wood (2014), неравенство (2), $\\mathrm{tw}(L(G))\\le (\\mathrm{tw}(G)+1)\\Delta(G)-1$
  (`../../resources/downloads/harvey_wood_2014_treewidth_line_graphs.pdf`).
  Следовательно $w(G)=O(\\mathrm{tw}(G)\\,\\Delta(G))$ и потому
  $$n^{O(w(G))}=2^{O(w(G)\\log n)}=2^{O(\\mathrm{tw}(G)\\,\\Delta(G)\\log n)}.$$
- `Toy‑тест:` для звезды $K_{1,n}$: $\\mathrm{tw}(G)=1$, $\\Delta(G)=n$, и формула даёт $2^{O(n\\log n)}$, что согласуется с $n^{O(w)}$ при $w=n-1$ (16.101).
- `Статус:` доказано (вывод из известных фактов).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` обновить формулировку в §16.98/Cor. 34, чтобы $2^{O(\\mathrm{tw}(G)\\Delta(G)\\log n)}$ появлялось с явной ссылкой (закрыть Q20).

### 16.103. Исследовательский шаг: Tseitin‑width через branch‑width гиперграфа (Alekhnovich–Razborov 2011)

- `Линза:` Эквивалентность.
- `Утверждение:` Для любого связного графа $G$ и нечётной разметки $\sigma$ (так что Tseitin‑CNF $T(G,\sigma)$ невыполнима)
  branch‑width $\\mathrm{wb}(T(G,\\sigma))$ её «подлежащего гиперграфа» $H_{T(G,\\sigma)}$ удовлетворяет
  $$\\mathrm{wb}(T(G,\\sigma))=\\Theta\\bigl(W(T(G,\\sigma)\\vdash\\bot)\\bigr),$$
  где $W(F\\vdash\\bot)$ — минимальная resolution‑width (Alekhnovich–Razborov 2011, Thm. 2.12,
  `../../resources/downloads/alekhnovich_razborov_2011_satisfiability_branchwidth_tseitin.pdf`).
  При этом $H_{T(G,\\sigma)}$ совпадает с двойственным гиперграфом $G^*$ (с повторениями гиперрёбер), см. Remark 2.11 там же.
  Повторы гиперрёбер не меняют $\\mathrm{wb}$ для этого случая, см. §16.106.
  В частности, вместе с точной формулой §16.101 получаем сравнение
  $$\\mathrm{wb}(T(G,\\sigma))=\\Theta\\bigl(\\max\\{\\Delta(G),\\mathrm{tw}(L(G))\\}\\bigr).$$
- `Toy‑тест:` для $K_{1,n}$ имеем $W=n$ (16.101) и $\\mathrm{wb}=\\Theta(n)$ по Thm. 2.12; для $C_n$ имеем $W=2$ и $\\mathrm{wb}=\\Theta(1)$.
- `Статус:` известный факт (точная ссылка; закрывает Q21).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` если нужно использовать без $\\Theta(\\cdot)$, извлечь из доказательства Thm. 2.12 явные константы в обе стороны (см. Q22).

### 16.104. Исследовательский шаг: явные константы в $\\mathrm{wb}(T(G,\\sigma))=\\Theta(W(T(G,\\sigma)\\vdash\\bot))$

- `Линза:` Эквивалентность.
- `Утверждение:` Пусть $G$ — связный граф и $T(G,\\sigma)$ — соответствующая невыполнимая Tseitin‑CNF. Обозначим
  $$W:=W(T(G,\\sigma)\\vdash\\bot),\\qquad B:=\\mathrm{wb}(T(G,\\sigma)),$$
  где $W$ — минимальная resolution‑width, $B$ — branch‑width подлежащего гиперграфа (AR’11 Remark 2.11). Тогда выполнены явные неравенства
  $$\\frac{1}{8}B\\ \\le\\ W\\ \\le\\ 2B.$$
- `Доказательство (из AR’11, §4):`
  1) (Gaussian width) Пусть $w_g(G,\\sigma)$ — минимальная ширина Gaussian‑рефутации (Def. 4.2). Тогда по Prop. 4.3
     $$\\tfrac12 W\\le w_g(G,\\sigma)\\le W.$$
  2) (Branch‑width vs Gaussian width) В доказательстве Lemma 4.4 показано, что $B\\ge w_g(G,\\sigma)$ (tree‑like restriction),
     а «алгоритм Figure 3.1 + obstacle‑аргумент» даёт $B\\le 8\\,w_g(G,\\sigma)$ (повторяется оценка из доказательства Lemma 3.1).
     Следовательно $w_g(G,\\sigma)\\le B\\le 8w_g(G,\\sigma)$.
  3) Комбинируя 1)–2), получаем $W\\le 2w_g\\le 2B$ и $B\\le 8w_g\\le 8W$, т.е. $B/8\\le W\\le 2B$.
  Ссылки: `../../resources/downloads/alekhnovich_razborov_2011_satisfiability_branchwidth_tseitin.pdf`.
- `Toy‑тест:` для $K_{1,n}$ (16.101) $W=n$ и $B\\ge r(H)=n$, поэтому $B/8\\le W\\le 2B$ выполняется; для $C_n$ имеем $W=2$ и $B=\\Theta(1)$.
- `Статус:` доказано (из явных констант в AR’11).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` если хочется убрать константу 8, проверить, можно ли в Lemma 4.4 получить $B\\le c\\,w_g$ с меньшим $c$ (или равенство) для $G^*$.

### 16.105. Исследовательский шаг: $\\mathrm{wb}(G^*)=\\mathrm{cw}(G)$ (branch‑width двойственного гиперграфа = carving width)

- `Линза:` Эквивалентность.
- `Утверждение:` Пусть $G=(V,E)$ — связный граф, а $G^*$ — его двойственный гиперграф с множеством вершин $E$ и гиперрёбрами
  $E(v)=\\{e\\in E: e\\text{ инцидентно }v\\}$ для $v\\in V$. Тогда
  $$\\mathrm{wb}(G^*)=\\mathrm{cw}(G),$$
  где $\\mathrm{wb}$ — branch‑width гиперграфа (AR’11, Def. 2.1), а $\\mathrm{cw}$ — carving width графа $G$ (как в §16.99–16.100).
- `Доказательство:` В branch‑decomposition гиперграфа $G^*$ листья соответствуют гиперрёбрам $E(v)$, то есть вершинам $v\\in V$.
  Пусть $(T,\\theta)$ — branch‑decomposition $G^*$. Определим разметку листьев $\\chi: \\mathrm{Leaves}(T)\\to V$ как $\\chi(\\theta(E(v)))=v$.
  Рассмотрим любой ненулевой узел $t$ дерева (т.е. $t\\ne\\mathrm{root}$) и пусть $S_t\\subseteq V$ — множество вершин, чьи листья лежат в поддереве $t$.
  Тогда по определению AR’11 (Def. 2.1) имеем
  $$\\mathrm{Cut}(t)=\\Bigl(\\bigcup_{v\\in S_t}E(v)\\Bigr)\\cap\\Bigl(\\bigcup_{v\\notin S_t}E(v)\\Bigr)=\\delta_G(S_t),$$
  то есть множество рёбер графа $G$, пересекающих разрез $S_t\\sqcup(V\\setminus S_t)$.
  Поэтому порядок узла $t$ равен $|\\delta_G(S_t)|$.
  Замечая, что каждому узлу $t\\ne\\mathrm{root}$ соответствует ребро $t\\text{--parent}(t)$, получаем carving‑декомпозицию $G$ на том же дереве $T$
  (игнорируя ориентацию): ширина разреза на ребре $t\\text{--parent}(t)$ равна $|\\delta_G(S_t)|=|\\mathrm{Cut}(t)|$.
  Отсюда $\\mathrm{cw}(G)\\le \\mathrm{wb}(G^*)$.

  В обратную сторону: из любой carving‑декомпозиции $(T,\\chi)$ графа $G$ (листья помечены вершинами) строим branch‑decomposition $G^*$,
  положив $\\theta(E(v)):=\\chi^{-1}(v)$. Для узла $t\\ne\\mathrm{root}$ множество $S_t$ листьев в поддереве снова задаёт разрез вершин,
  и та же формула показывает $\\mathrm{Cut}(t)=\\delta_G(S_t)$. Значит ширины совпадают на каждом соответствующем разрезе, и
  $\\mathrm{wb}(G^*)\\le \\mathrm{cw}(G)$.
  Совместно: $\\mathrm{wb}(G^*)=\\mathrm{cw}(G)$.
- `Toy‑тест:` для звезды $K_{1,n}$: $\\mathrm{cw}(K_{1,n})=n$ (любой разрез, отделяющий центр от листа, режет $n$ рёбер) и $G^*$ имеет гиперрёбра
  размеров $n$ и $1$, так что $\\mathrm{wb}(G^*)=n$; для цикла $C_n$: $\\mathrm{cw}(C_n)=2$ и $\\mathrm{wb}(C_n^*)=2$.
- `Статус:` доказано (закрывает Q23).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` использовать $\\mathrm{wb}(G^*)=\\mathrm{cw}(G)$, чтобы переписать AR‑параметры для Tseitin (Remark 2.11) напрямую через carving width,
  и сравнить с treewidth‑формулой §16.101.

### 16.106. Исследовательский шаг: повторы гиперрёбер в $G^*$ не меняют $\\mathrm{wb}$ (для применения Remark 2.11)

- `Линза:` Эквивалентность.
- `Утверждение:` Пусть $G=(V,E)$ — связный граф без петель. Обозначим двойственный гиперграф
  $$G^* := \\bigl(E,\\ \\{E(v): v\\in V\\}\\bigr),\\qquad E(v):=\\{e\\in E: e\\text{ инцидентно }v\\}.$$
  Пусть $\\widetilde G^*$ — мультигиперграф на том же множестве вершин $E$, в котором каждое гиперребро $E(v)$ повторено $m_v\\ge 1$ раз.
  Тогда
  $$\\mathrm{wb}(\\widetilde G^*)=\\mathrm{wb}(G^*).$$
  В частности, по AR’11 Remark 2.11 подлежащий гиперграф Tseitin‑CNF $T(G,\\sigma)$ — это ровно $\\widetilde G^*$ при $m_v=2^{\\deg_G(v)-1}$, и потому
  $$\\mathrm{wb}(T(G,\\sigma))=\\mathrm{wb}(H_{T(G,\\sigma)})=\\mathrm{wb}(G^*).$$
- `Доказательство:`
  1) (**Монотонность по удалению гиперрёбер.**) Если $H'=(V,E')$ получается из $H=(V,E)$ удалением гиперрёбер (подмультисет $E'\\subseteq E$),
     то $\\mathrm{wb}(H')\\le \\mathrm{wb}(H)$.
     Действительно, возьмём branch‑decomposition $(T,\\theta)$ для $H$.
     Рассмотрим минимальное поддерево $T'\\subseteq T$, натянутое на листья $\\theta(E')$,
     и подавим в нём все вершины степени 2 (получая снова бинарное корневое дерево) — это даёт branch‑decomposition для $H'$.
     Для каждого узла $t$ в новом дереве множества гиперрёбер‑потомков на обеих сторонах разреза — подмножества соответствующих множеств в $T$,
     поэтому $V(t)$ и $V^\\perp(t)$ только уменьшаются, а значит $|\\mathrm{Cut}(t)|=|V(t)\\cap V^\\perp(t)|$ не растёт.
  2) (**Нижняя оценка $\\mathrm{wb}(G^*)\\ge \\Delta(G)$.**) Для любого $v\\in V$ и любого branch‑decomposition $(T,\\theta)$ гиперграфа $G^*$
     лист $t_v:=\\theta(E(v))$ имеет
     $$\\mathrm{Cut}(t_v)=E(v)\\cap\\bigcup_{u\\ne v}E(u)=E(v),$$
     поскольку каждое ребро $e\\in E(v)$ также инцидентно некоторому $u\\ne v$ (нет петель).
     Следовательно, порядок листа равен $|E(v)|=\\deg_G(v)$, и потому $\\mathrm{wb}(G^*)\\ge \\max_v \\deg_G(v)=\\Delta(G)$.
  3) (**Строим декомпозицию для $\\widetilde G^*$.**) Пусть $(T,\\theta)$ — оптимальная branch‑decomposition $G^*$ ширины $w:=\\mathrm{wb}(G^*)$.
     Для каждого $v\\in V$ заменим лист $\\theta(E(v))$ на бинарное поддерево с $m_v$ листьями,
     помеченными $m_v$ копиями гиперребра $E(v)$ (корень поддерева занимает место старого листа).
     Получим branch‑decomposition $(\\widetilde T,\\widetilde\\theta)$ гиперграфа $\\widetilde G^*$.
     Для узлов вне добавленных поддеревьев разрезы не меняются: на каждой стороне теперь стоит либо ноль, либо все копии $E(v)$,
     и объединение по копиям равно $E(v)$.
     Для узла $t$ внутри поддерева, соответствующего $v$, на обеих сторонах разреза есть хотя бы одна копия $E(v)$,
     поэтому $V(t)=V^\\perp(t)=E(v)$ и $|\\mathrm{Cut}(t)|=|E(v)|=\\deg_G(v)\\le \\Delta(G)\\le w$ (по п. 2).
     Следовательно, ширина $(\\widetilde T,\\widetilde\\theta)$ не превосходит $w$, то есть $\\mathrm{wb}(\\widetilde G^*)\\le \\mathrm{wb}(G^*)$.
  4) В обратную сторону, $G^*$ получается из $\\widetilde G^*$ удалением копий гиперрёбер, поэтому по п. 1
     $\\mathrm{wb}(G^*)\\le \\mathrm{wb}(\\widetilde G^*)$.
     Совместно: $\\mathrm{wb}(\\widetilde G^*)=\\mathrm{wb}(G^*)$.
- `Toy‑тест:`
  1) Для $K_{1,n}$ гиперребро $E(\\text{центр})$ повторяется $2^{n-1}$ раз, но оба значения $\\mathrm{wb}(G^*)$ и $\\mathrm{wb}(\\widetilde G^*)$ равны $n$ (см. §16.105).
  2) (Почему утверждение нельзя обобщать.) Если $H$ имеет два непересекающихся гиперребра $A,B$ размера $r$, то $\\mathrm{wb}(H)=0$,
     но при добавлении второй копии $A$ получаем $\\mathrm{wb}\\ge |A|=r$ (лист, соответствующий одной копии).
- `Статус:` доказано (закрывает Q24).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` в основном тексте (или итоговой ремарке для §16.103–16.105) можно свести цепочку AR’11 к краткой формуле
  $W(T(G,\\sigma)\\vdash\\bot)=\\Theta(\\mathrm{cw}(G))$ через $\\mathrm{wb}(T)=\\mathrm{wb}(G^*)=\\mathrm{cw}(G)$.

### 16.107. Исследовательский шаг: $W(T(G,\\sigma)\\vdash\\bot)=\\Theta(\\mathrm{cw}(G))$ (явные константы)

- `Линза:` Эквивалентность.
- `Утверждение:` Пусть $G$ — связный граф без петель, а $\\sigma:V(G)\\to\\{0,1\\}$ такова, что Tseitin‑CNF $T(G,\\sigma)$ невыполнима.
  Обозначим $W:=W(T(G,\\sigma)\\vdash\\bot)$ минимальную resolution‑width. Тогда
  $$\\frac{1}{8}\\,\\mathrm{cw}(G)\\ \\le\\ W\\ \\le\\ 2\\,\\mathrm{cw}(G).$$
  В частности, $W(T(G,\\sigma)\\vdash\\bot)=\\Theta(\\mathrm{cw}(G))$.
- `Доказательство:` По §16.104 имеем $\\tfrac18\\,\\mathrm{wb}(H_{T(G,\\sigma)})\\le W\\le 2\\,\\mathrm{wb}(H_{T(G,\\sigma)})$ (AR’11, Thm. 2.12 + §4).
  По AR’11 Remark 2.11, $H_{T(G,\\sigma)}$ — это мульти‑$G^*$, а по §16.106 повторения гиперрёбер не меняют $\\mathrm{wb}$, значит
  $\\mathrm{wb}(H_{T(G,\\sigma)})=\\mathrm{wb}(G^*)$.
  По §16.105, $\\mathrm{wb}(G^*)=\\mathrm{cw}(G)$. Подстановка даёт требуемое неравенство.
- `Toy‑тест:` для $K_{1,n}$ имеем $\\mathrm{cw}(K_{1,n})=n$ и $W=n$ (по формуле §16.101); для цикла $C_n$ имеем $\\mathrm{cw}(C_n)=2$ и $W=2$.
- `Статус:` доказано (закрывает Q25).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` проверить «планарные графы с ограниченной степенью граней ⇒ ограниченная cyclicity $\\ell(G)$» из AR’11 (абзац после Thm. 2.16),
  чтобы понимать, когда $W\\le \\ell(G)^{O(1)}\\log S$ реально даёт автоматизируемость.

### 16.108. Исследовательский шаг: bounded face degree (planar) ⇒ bounded cyclicity $\\ell(G)$ (уточнение ремарки AR’11 после Thm. 2.16)

- `Линза:` Эквивалентность.
- `Утверждение:` Пусть $G$ — связный планарный граф, который допускает вложение в плоскость, в котором каждая грань имеет степень $\\le d$
  (длина граничного обхода, считая кратности), и пусть $G$ 2‑реберно‑связен (нет мостов).
  Тогда cyclicity $\\ell(G)$ из AR’11 Def. 2.14 удовлетворяет
  $$\\ell(G)\\le \\max\\{d,2\\}.$$
- `Доказательство:`
  Рассмотрим фиксированное плоское вложение. Для каждой грани $f$ возьмём её граничный замкнутый обход $W_f$ длины $\\deg(f)\\le d$.
  Так как у $G$ нет мостов, каждое ребро инцидентно двум различным граням и потому встречается в каждом из двух обходов ровно по одному разу
  (эквивалентно: ребро входит в границу одной и той же грани дважды тогда и только тогда, когда это мост).
  Следовательно, $W_f$ — замкнутый обход без повторений рёбер.

  Любой такой обход раскладывается на попарно непересекающиеся по рёбрам простые циклы (индукция по длине: если в $W_f$ повторяется вершина,
  то разрежем обход в месте повтора на два более коротких замкнутых обхода; иначе это уже простой цикл).
  В частности, все циклы в разложении имеют длину $\\le |W_f|\\le d$, и каждое ребро, лежащее на границе $f$, принадлежит ровно одному циклу из этого разложения.

  Возьмём объединение циклов по всем граням. Тогда каждый ребро $e$ принадлежит ровно двум граням, значит попадает не более чем в два цикла (по одному «со стороны» каждой грани),
  и все циклы имеют длину $\\le d$. Это и есть покрытие рёбер циклами, удовлетворяющее определению cyclicity с параметром $\\max\\{d,2\\}$.
- `Toy‑тест:` треугольник с «хвостом» (подвешенным ребром‑мостом) имеет вложение с $d=5$, но покрытие рёбер циклами невозможно (мост не лежит ни в одном цикле),
  так что условие «нет мостов» действительно нужно.
- `Статус:` доказано (закрывает Q26; объясняет ремарку AR’11 после Thm. 2.16,
  `../../resources/downloads/alekhnovich_razborov_2011_satisfiability_branchwidth_tseitin.pdf`).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` если нужно использовать Theorem 2.15 количественно, извлечь из доказательства AR’11 явную степень в $\\ell(G)^{O(1)}$ (вместо $O(1)$).

### 16.109. Исследовательский шаг: явная степень в AR’11 Thm. 2.15 (получается $\\ell^7$)

- `Линза:` Трейд‑офф.
- `Утверждение:` Пусть $G$ — связный граф, для которого cyclicity $\\ell(G)<\\infty$, и $\\sigma$ — нечётная разметка (так что $T(G,\\sigma)$ невыполнима).
  Обозначим $\\ell:=\\ell(G)$, $W:=W(T(G,\\sigma)\\vdash\\bot)$ минимальную resolution‑width и $S:=S(T(G,\\sigma)\\vdash\\bot)$ минимальный размер резолюционного опровержения.
  Тогда существует абсолютная константа $C>0$ такая, что
  $$W\\le C\\,\\ell^7\\,\\log S.$$
  В частности, это делает явной степень в записи AR’11 $W\\le \\ell(G)^{O(1)}\\log S$.
- `Доказательство:` В доказательстве AR’11 Thm. 2.15 (раздел 5) получены две оценки:
  (i) по (5.4) $W(T(G,\\sigma)\\vdash\\bot)\\le O(\\ell\\cdot W(T(G,\\sigma)|\\rho\\vdash\\bot))$ для построенной случайной рестрикции $\\rho$;
  (ii) по (5.6) с «overwhelming probability» выполняется $W(T(G,\\sigma)|\\rho\\vdash\\bot)\\le O(\\ell^6\\log S)$.
  Перемножая, получаем $W\\le O(\\ell^7\\log S)$.
  Ссылка: `../../resources/downloads/alekhnovich_razborov_2011_satisfiability_branchwidth_tseitin.pdf`, §5 (уравнения (5.4) и (5.6)).
- `Toy‑тест:` если $\\ell$ ограничена абсолютной константой, то $W=O(\\log S)$ (smoothness).
  Совместно с §16.108: для 2‑реберно‑связных плоских графов с $\\max\\deg(\\text{face})\\le d$ получаем $W\\le O(d^7\\log S)$.
- `Статус:` известный факт (явное извлечение степени; закрывает Q27).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` аналогично попытаться сделать явной зависимость в AR’11 Thm. 2.17 (квази‑smoothness через $\\tilde\\ell(G)$).

### 16.110. Исследовательский шаг: явная константа в Thm. 2.17 (можно взять $c=6$)

- `Линза:` Трейд‑офф.
- `Утверждение:` Пусть $G$ — связный граф, $\\tilde\\ell:=\\tilde\\ell(G)<\\infty$ — параметр AR’11 (после Thm. 2.16),
  $\\sigma$ — нечётная разметка (так что $T(G,\\sigma)$ невыполнима), $W:=W(T(G,\\sigma)\\vdash\\bot)$ — минимальная resolution‑width,
  $S:=S(T(G,\\sigma)\\vdash\\bot)$ — минимальный размер резолюционного опровержения. Тогда для некоторой абсолютной константы $C>0$ верно
  $$W\\le (C\\,\\tilde\\ell\\,\\log S)^{6\\tilde\\ell^2}.$$
  Это делает явной зависимость в AR’11 Thm. 2.17: $W\\le (\\tilde\\ell\\log S)^{O(\\tilde\\ell^2)}$.
- `Доказательство:` В доказательстве AR’11 Thm. 2.17 (раздел 5) фиксируют $\\ell:=\\tilde\\ell(G)$ и получают:
  1) по (5.12) существует (с вероятностью $1-O(S^{-1})$) ограничение $\\rho$ такое, что
     $$W(T(G,\\sigma)|\\rho\\vdash\\bot)\\le w:=\\bigl(K\\ell^2\\log S\\bigr)^{\\ell}.$$
  2) по Claim 5.17, при условии регулярности $E_p$ (Claim 5.16) из $W(T|\\rho)\\le w$ следует
     $$\\mathrm{wb}(T(G,\\sigma)\\vdash\\bot)\\le w^2 + R,$$
     где $R$ — число «relevant edges» для некоторой пары $(V_0,V_1)$ с $|V_0|,|V_1|\\le w$.
  3) Делаем оценку $R$ явной: в определении $P_{V_0,V_1}$ все пути имеют длину $\\le 2\\ell-1$, значит каждое множество рёбер в семье имеет размер $\\le 2\\ell$.
     После plucking‑процедуры в $F_{V_0,V_1}$ нет sunflower‑семейства размера $r$ среди минимальных элементов, где $r=C_0 w\\log n$ (см. (5.15)), $n:=|V(G)|$.
     Поэтому по Erdős–Rado (Prop. 5.8) получаем явную оценку
     $$|F_{V_0,V_1}|\\le (2\\ell)!\\,(r-1)^{2\\ell}\\le (2\\ell)!\\,r^{2\\ell},$$
     а значит число relevant edges удовлетворяет
     $$R\\le (2\\ell)\\,|F_{V_0,V_1}|\\le 2\\ell\\,(2\\ell)!\\,r^{2\\ell}.$$
  4) Подстановка $r=C_0 w\\log n$ даёт
     $$R\\le 2\\ell\\,(2\\ell)!\\,(C_0\\log n)^{2\\ell}\\,w^{2\\ell}.$$
     По §16.112 имеем $S\\ge n$, значит $\\log n\\le \\log S$.
     Также $(2\\ell)!\\le (2\\ell)^{2\\ell}$, поэтому
     $$2\\ell\\,(2\\ell)!\\,(C_0\\log n)^{2\\ell}\\le (C_1\\,\\ell\\,\\log S)^{4\\ell}.$$
     Следовательно,
     $$\\mathrm{wb}(T(G,\\sigma)\\vdash\\bot)\\le w^2 + (C_1\\ell\\log S)^{4\\ell}\\,w^{2\\ell}.$$
  5) Так как $w=(K\\ell^2\\log S)^{\\ell}$, имеем $w^{2\\ell}=(K\\ell^2\\log S)^{2\\ell^2}$, а множитель $(C_1\\ell\\log S)^{4\\ell}$
     увеличивает степень не более чем на $4\\ell\\le 4\\ell^2$.
     Поэтому (поглощая константы и переходя от branch‑width к width через AR’11 Thm. 2.12 + Remark 2.11 + §16.106) получаем
     $$W\\le (C\\,\\ell\\,\\log S)^{6\\ell^2}.$$
- `Toy‑тест:` если $\\ell=O(1)$, то $W\\le (\\log S)^{O(1)}$ (quasi‑smoothness) согласуется с формулировкой AR’11.
- `Статус:` доказано (грубая явная константа; закрывает Q28).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` если нужно, улучшить грубую константу 6 (уточнить оценки на $|F_{V_0,V_1}|$ / relevant edges).

### 16.111. Исследовательский шаг: итог AR’11 (Thm. 2.15/2.17/2.18) в «употребимом» виде

- `Линза:` Эквивалентность.
- `Утверждение:` Пусть $G$ — связный граф, $\\sigma$ — нечётная разметка (так что Tseitin‑CNF $T(G,\\sigma)$ невыполнима), и
  $W:=W(T(G,\\sigma)\\vdash\\bot)$, $S:=S(T(G,\\sigma)\\vdash\\bot)$.
  Тогда:
  1) (**Smoothness через cyclicity.**) Если $\\ell:=\\ell(G)$ конечна, то
     $$W\\le O(\\ell^7\\log S)$$
     (AR’11, (5.4)+(5.6); явная степень выписана в §16.109).
     В частности, если $G$ 2‑реберно‑связен, планарен и $\\max\\deg(\\text{face})\\le d$, то $\\ell(G)\\le\\max\\{d,2\\}$ (§16.108) и потому
     $$W\\le O(d^7\\log S).$$
  2) (**Quasi‑smoothness через $\\tilde\\ell$.**) Если $\\tilde\\ell:=\\tilde\\ell(G)$ конечна, то
     $$W\\le (C\\,\\tilde\\ell\\,\\log S)^{6\\tilde\\ell^2}$$
     (AR’11, Claim 5.17/(5.18); явная константа $6$ выписана в §16.110).
  3) (**Без параметров.**) Для любого $G$ выполняется
     $$W\\le O(\\log S + |V(G)|)$$
     (AR’11, Thm. 2.18).
- `Toy‑тест:` при фиксированном $d$ в (1) получаем $W=O(\\log S)$ (smoothness), а при фиксированном $\\tilde\\ell$ в (2) получаем $W\\le (\\log S)^{O(1)}$ (quasi‑smoothness).
- `Статус:` доказано (сводка; закрывает Q29).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` по необходимости перенести этот итог в основной текст (не таща доказательства) как 3–6 строк с ссылкой на AR’11 и §16.108–16.110.

### 16.112. Исследовательский шаг: для Tseitin $S(T(G,\\sigma)\\vdash\\bot)\\ge |V(G)|$ (и потому $\\log n\\le\\log S$)

- `Линза:` Инвариант.
- `Утверждение:` Пусть $G$ — связный граф без петель, $\\sigma:V(G)\\to\\{0,1\\}$ нечётна (так что Tseitin‑CNF $T(G,\\sigma)$ невыполнима).
  Для вершины $v\\in V(G)$ обозначим через $B_v$ множество клауз в блоке $\\mathrm{PARITY}_{v,\\sigma(v)}$ (см. AR’11, (2.9)).
  Тогда CNF $T(G,\\sigma)\\setminus B_v$ выполнима. В частности, любая резолюционная рефутация $T(G,\\sigma)$ должна использовать
  хотя бы одну исходную клаузу из каждого блока $B_v$, и потому
  $$S(T(G,\\sigma)\\vdash\\bot)\\ge |V(G)|.$$
- `Доказательство:`
  1) (**Выполнимость после удаления одного блока.**) Зафиксируем вершину $r$ и построим удовлетворяющее присваивание для всех вершин $v\\ne r$.
     Возьмём остовное дерево $T$ графа $G$ с корнем $r$. Положим $x_e:=0$ для всех рёбер $e\\notin E(T)$.
     Обойдём вершины $T$ снизу вверх. Для каждой $v\\ne r$ пусть $p(v)$ — родитель, $e_v:=(v,p(v))$ — ребро к родителю.
     Когда значения $x_f$ уже заданы для всех рёбер $f$ инцидентных $v$, кроме $e_v$, положим
     $$x_{e_v}:=\\sigma(v)\\oplus \\bigoplus_{f\\ni v,\\ f\\ne e_v} x_f.$$
     Тогда у вершины $v$ выполняется требуемое уравнение $\\bigoplus_{f\\ni v}x_f=\\sigma(v)$.
     Значит присваивание удовлетворяет всем XOR‑ограничениям для $v\\ne r$ и, следовательно, удовлетворяет всем клаузам из блоков $B_v$ при $v\\ne r$.
     Так как блок $B_r$ удалён, получаем выполнимость $T(G,\\sigma)\\setminus B_r$.
  2) (**Отсюда нижняя оценка на размер.**) Если резолюционная рефутация $\\pi$ не использует ни одной исходной клаузы из блока $B_v$,
     то она является резолюционной рефутацией выполнимой CNF $T(G,\\sigma)\\setminus B_v$, что невозможно по корректности резолюции.
     Следовательно, $\\pi$ использует хотя бы одну исходную клауза из каждого блока, и число клауз в $\\pi$ не меньше $|V(G)|$,
     то есть $S(T(G,\\sigma)\\vdash\\bot)\\ge |V(G)|$.
- `Toy‑тест:` для цикла $C_3$ с нечётной $\\sigma$ (ровно одна вершина с зарядом 1) удаление блока этой вершины делает систему из двух XOR‑уравнений
  совместной; дерево‑конструкция выше явно находит решение.
- `Статус:` доказано (закрывает Q30).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` использовать как подстановку $\\log|V(G)|\\le\\log S$ в местах, где $n$ появляется внутри $\\log$ (например, в оценках из AR’11 §5).

### 16.113. Исследовательский шаг: Frege‑«line replacement» по эквивалентности $A\\leftrightarrow A'$

- `Линза:` Сжатие/канонизация.
- `Утверждение:` Пусть $\\Gamma$ — множество формул, и в Frege‑выводе из $\\Gamma$ уже получена формула $A$.
  Если также есть Frege‑вывод (без гипотез) тавтологии $A\\leftrightarrow A'$, то из $\\Gamma$ выводится $A'$.
  Более того, $A'$ можно вставить в вывод сразу после $A$ с $O(1)$ дополнительными строками (плюс вывод $A\\leftrightarrow A'$).
- `Доказательство:` Пишем $A\\leftrightarrow A'$ как $(A\\to A')\\wedge(A'\\to A)$.
  В любой Frege‑системе есть короткие (константные) выводы тавтологий
  $((X\\wedge Y)\\to X)$ и $((X\\wedge Y)\\to Y)$.
  Применяя modus ponens к строке $(A\\to A')\\wedge(A'\\to A)$, получаем строку $A\\to A'$,
  а затем modus ponens к строкам $A$ и $A\\to A'$ даёт $A'$.
  (Аналогично из $A'$ и $A\\leftrightarrow A'$ выводится $A$.)
- `Оценка blow-up:` одна замена линии добавляет константное число строк сверх вывода эквивалентности $A\\leftrightarrow A'$,
  т.е. если $|\\pi|$ — длина исходного вывода и $E$ — суммарная длина добавленных выводов эквивалентностей, то новый вывод имеет длину $O(|\\pi|+E)$.
- `Toy‑тест:` для $A=(p\\vee q)\\vee r$ и $A'=p\\vee(q\\vee r)$: из $A$ и ассоциативности $\\vee$ (как $A\\leftrightarrow A'$) выводим $A'$.
- `Статус:` доказано (закрывает Q32).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` если нужно для строгой «log‑depth» интерпретации, зафиксировать (ссылкой), что выбранная схема балансировки даёт
  полиномиальный Frege‑вывод эквивалентности $A\\leftrightarrow A'$ для каждой линии (иначе пользоваться переводом Buss’97 из §16.95).

### 16.114. Исследовательский шаг: Spira‑балансировка даёт p‑размерные Frege‑доказательства $A\\leftrightarrow A'$

- `Линза:` Эквивалентность.
- `Утверждение:` Существует стандартная Spira‑схема балансировки формул $A\\mapsto A'$ глубины $O(\\log|A|)$ и размера $\\mathrm{poly}(|A|)$, для которой
  тавтологии $A\\leftrightarrow A'$ имеют полиномиальные Frege‑доказательства. Следовательно, аргумент 16.94 «балансировать каждую линию» можно
  проводить строго через §16.113.
- `Обоснование/ссылка:` в Buss (1997), Proof (Sketch) к Theorem 3 (p. 8),
  `../../resources/downloads/buss_1997_proof_complexity_intro.pdf`,
  прямо отмечено, что в доказательстве p‑симуляции Frege‑систем по Rekhow/Spira
  «must prove that there are polynomial size proofs that the Spira translation of a conjunction $A\\wedge B$ is equivalent to the conjunction of the Spira translations of $A$ and $B$»,
  т.е. корректность Spira‑перевода (и, в частности, эквивалентность исходной формулы и её балансировки) верифицируется внутри Frege с полиномиальным blow‑up.
- `Toy‑тест:` для $A=(p\\vee q)\\vee r$ и $A'=p\\vee(q\\vee r)$ эквивалентность $A\\leftrightarrow A'$ выводится из ассоциативности $\\vee$ константным числом строк (см. §16.113).
- `Статус:` известный факт (точная ссылка; закрывает Q33).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` вернуться к 16.93: либо найти источник с явной конструкцией $O(\\log n)$‑depth Frege‑рефутации Tseitin, либо оставлять только «перевод Buss’97/Spira» как строгую верхнюю оценку по глубине (16.95).

### 16.115. Исследовательский шаг: когда верхняя оценка GIRS’19 Thm. 19 становится polynomial‑size?

- `Линза:` Трейд‑офф.
- `Утверждение:` Пусть $t:=\\mathrm{tw}(G)$ и $\\Delta:=\\Delta(G)$.
  Из доказательства GIRS’19 Thm. 27/Claim 28 (разд. 4.3; см. также §16.119–§16.120) получается **нециркулярная** явная форма верхней оценки:
  для любого $d\\ge 1$ существует bounded‑depth Frege‑рефутация глубины $O(d)$ и размера
  $$\\mathrm{poly}(|\\mathrm{Tseitin}(G,f)|)\\cdot 2^{\\,O\\bigl(d\\cdot X^{2/d}\\bigr)},\\qquad X:=\\Delta\\,\\mathrm{tpw}(G).$$
  Подставляя $\\mathrm{tpw}(G)\\le 10\\Delta\\,t$ (GIRS’19 Thm. 26), получаем
  $$\\mathrm{poly}(|\\mathrm{Tseitin}(G,f)|)\\cdot 2^{\\,O\\bigl(d\\cdot (10\\Delta^2 t)^{2/d}\\bigr)}.$$
  В частности, гарантированно polynomial‑size следует уже при $d=\\Theta(\\log(10\\Delta^2 t))$ (тогда $(10\\Delta^2 t)^{2/d}=\\exp(O(1))$ и экспонента становится $O(\\log t)$).
- `Доказательство:` по Claim 28 (GIRS’19, p. 13) размер game tree ограничен $\\mathrm{poly}(|T|)$ и доминирующими слагаемыми вида
  $2^{O(\\sum_{i=1}^d t_i)}$, где в доказательстве Thm. 27 выбирают $t_i=(\\Delta\\,\\mathrm{tpw}(G))^{2/d}$ для всех $i$ (p. 14),
  так что $\\sum_i t_i=d\\cdot X^{2/d}$. Константы в переходе Lemma 24/25 фиксируются в §16.118, и потому итоговый размер
  имеет вид $\\mathrm{poly}(|T|)\\cdot 2^{O(d\\cdot X^{2/d})}$. Подстановка Thm. 26 даёт формулу через $t$.
- `Toy‑тест:` если $d=\\Theta(\\log t)$, то $X^{2/d}=\\exp(O(1))$, и оценка становится $2^{O(\\log t)}=\\mathrm{poly}(t)$.
- `Статус:` доказано (исправляет 16.115: из GIRS’19 **не следует** polynomial‑size при $d=\\Theta(\\log t/\\log\\log t)$ без доп. идей; см. §16.120).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` для grid переписать итог в терминах $N$ и сопоставить с Håstad’20 Cor. 6.6 (см. §16.116 и §16.120).

### 16.116. Исследовательский шаг: Tseitin(Grid) — порог глубины polynomial‑size в терминах $N$

- `Линза:` Трейд‑офф.
- `Утверждение:` Пусть $G$ — $n\\times n$ grid и $T:=\\mathrm{Tseitin}(G,f)$ — соответствующая Tseitin‑CNF.
  Обозначим через $N$ число переменных в $T$ (для стандартного кодирования $N=\\Theta(|E(G)|)=\\Theta(n^2)$).
  Тогда:
  1) (**Нижняя оценка.**) Любая polynomial‑size Frege‑рефутация в depth‑$d$ требует
     $$d\\ =\\ \\Omega\\!\\left(\\frac{\\log N}{\\log\\log N}\\right)$$
     (Håstad’20, Cor. 6.6; см. §16.92).
  2) (**Верхняя оценка.**) Polynomial‑size Frege‑рефутации существуют при глубине
     $$d\\ =\\ O(\\log N)$$
     (например, из GIRS’19: polynomial‑size уже при $d=\\Theta(\\log\\mathrm{tw}(G))=\\Theta(\\log n)=\\Theta(\\log N)$; см. §16.115 и §16.120).
  Следовательно, известная зона для минимальной глубины polynomial‑size на grid:
  $$\\Omega\\!\\left(\\frac{\\log N}{\\log\\log N}\\right)\\ \\le\\ d_{\\mathrm{poly}}(N)\\ \\le\\ O(\\log N).$$
- `Доказательство:`
  1) (**Нижняя оценка.**) Это Cor. 6.6 из Håstad (2020) (см. §16.92), переписанная через $N=\\Theta(n^2)$.
  2) (**Верхняя оценка.**) Из §16.115 имеем polynomial‑size при глубине $d=\\Theta(\\log(\\Delta^2\\mathrm{tw}(G)))$.
     Для grid $\\Delta=4$ и $\\mathrm{tw}(G)=\\Theta(n)$, значит $d=\\Theta(\\log n)=\\Theta(\\log N)$.
- `Toy‑тест:` $N=n^2$ даёт $\\log N=2\\log n$ и $\\log\\log N=\\log(\\log n+\\log 2)=\\log\\log n+O(1)$, так что масштабы
  $\\log n/\\log\\log n$ и $\\log N/\\log\\log N$ совпадают по порядку.
- `Статус:` доказано (исправляет 16.116: порядок для $d_{\\mathrm{poly}}$ на grid **не** зафиксирован; известны только $\\Omega(\\log N/\\log\\log N)$ и $O(\\log N)$).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` если нужно для «главного текста», заменить «tight» на двусторонние границы $\\Omega(\\log N/\\log\\log N)$ и $O(\\log N)$ (см. `docs/15_proof_complexity.md`).

### 16.117. Исследовательский шаг: константы в пороге глубины для Tseitin(Grid) (Håstad’20 vs GIRS’19)

- `Линза:` Трейд‑офф.
- `Утверждение:` Для Tseitin(Grid$_{n,n}$) в bounded‑depth Frege:
  1) (**Явная нижняя константа.**) Из Håstad (2020), Cor. 6.6 (см. §16.92) следует, что polynomial‑size невозможен при
     $$\\mathrm{depth}\\le \\frac{\\log n}{59\\,\\log\\log n}.$$
  2) (**Известный upper.**) Из §16.115 (на базе GIRS’19 Thm. 27/26) следует polynomial‑size при глубине $\\mathrm{depth}=O(\\log n)=O(\\log N)$.
  Следовательно, «константное» сравнение вида $1/59$ vs “$9c$” невалидно: известная верхняя оценка для polynomial‑size находится на другом масштабе
  (между $\\Omega(\\log n/\\log\\log n)$ и $O(\\log n)$; см. §16.116), и задача — закрыть этот зазор (или объяснить барьер).
- `Доказательство:`
  1) Пункт (1) — это ровно Cor. 6.6 из Håstad (2020), как записано в §16.92.
  2) Для grid $\\Delta=4$, $\\mathrm{tw}(G)=\\Theta(n)$, и по §16.115 polynomial‑size получается при глубине $\\Theta(\\log n)$.
- `Toy‑тест:` при $d=\\alpha\\,\\log n/\\log\\log n$ из §16.115 получаем экспоненту $\\Theta(d\\cdot n^{2/d})=\\Theta\\bigl((\\log n)^{1+2/\\alpha}/\\log\\log n\\bigr)$,
  то есть гарантированно **не** polynomial‑size; чтобы сделать экспоненту $O(\\log n)$, нужен $d=\\Theta(\\log n)$.
- `Статус:` доказано (уточнён масштаб: известный upper для polynomial‑size — $O(\\log n)$, а не $\\Theta(\\log n/\\log\\log n)$).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` найти/построить upper на polynomial‑size при глубине $O(\\log n/\\log\\log n)$ (или аргумент, почему подход через “компактный parity” этого не даёт).

### 16.118. Исследовательский шаг: в GIRS’19 Lemma 24/25 можно взять явную константу $c=21$

- `Линза:` Трейд‑офф.
- `Утверждение:` В Galesi–Itsykson–Riazanov–Sofronova (2019) (GIRS’19) в Lemma 24 и Lemma 25
  (раздел 4.2, “Summation of linear equations”) можно выбрать константу $c=21$:
  для любого $d$ и любого $p(t_1,\\dots,t_d)$‑refinement $U$ существует вывод, заявленный в Lemma 24, размера
  $\\le 21\\cdot|\\Phi_1(\\varnothing,U)|^6$, и, следовательно, в Lemma 25 можно взять ту же константу (размер $\\le 21k\\cdot|\\Phi_1(\\varnothing,U)|^6$).
- `Доказательство:` в доказательстве Lemma 24 (GIRS’19, p. 10–11 в PDF‑нумерации) получена оценка
  $$\\text{size}\\ \\le\\ 2^{3t_1}\\,c\\,|\\Phi_1(\\varnothing,V^1)|^6\\ +\\ 20\\,|\\Phi_1(\\varnothing,U)|^6,$$
  и далее используется тождество (там же)
  $$|\\Phi_1(\\varnothing,U)|=2^{t_1+1}t_1\\,|\\Phi_1(\\varnothing,V^1)|.$$
  Подставляя, получаем
  $$2^{3t_1}c|\\Phi_1(\\varnothing,V^1)|^6
    =c\\,\\frac{2^{3t_1}}{2^{6(t_1+1)}t_1^6}\\,|\\Phi_1(\\varnothing,U)|^6
    \\le \\frac{c}{512}\\,|\\Phi_1(\\varnothing,U)|^6,$$
  так как $t_1\\ge 1$. Поэтому при $c=21$ имеем
  $$\\frac{c}{512}+20<21,$$
  и индуктивный шаг в Lemma 24 проходит с той же константой $c=21$ (база $d=0$ даёт константный размер и тем более укладывается в $21\\cdot|\\Phi_1(\\varnothing,U)|^6$).
  В Lemma 25 (p. 11) пункт (1) — это $(k-1)$ последовательных применений Lemma 24 с композицией по Lemma 2, поэтому размер
  $\\le k\\cdot 21\\cdot|\\Phi_1(\\varnothing,U)|^6$.
- `Toy‑тест:` при $t_1=1$ худший множитель в первом слагаемом равен $2^{3}/2^{12}=1/512$, и запас $21-20=1$ ещё остаётся.
- `Статус:` доказано (явная константа; полезно для Q39).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` распаковать оставшиеся “существует $c$”/big‑O в верхней оценке GIRS’19 Thm. 19 (p. 14):
  теперь единственные неявные константы сидят в переходе от Claim 28/Theorem 27 к форме $2^{(10\\Delta^2\\mathrm{tw})^{c/d}}$.

### 16.119. Исследовательский шаг: в GIRS’19 Thm. 19 можно взять явную константу $c=4$ (распаковка Claim 28 → Thm. 27)

- `Линза:` Трейд‑офф.
- `Утверждение:` Пусть $G$ — связный граф, $T:=\\mathrm{Tseitin}(G,f)$ невыполнима и $d\\ge 1$.
  Обозначим $X:=\\Delta(G)\\,\\mathrm{tpw}(G)$. Если $X^{1/d}\\ge \\max(2d,6)$, то в конструкции GIRS’19 (разд. 4.3)
  можно взять **явную** константу $c=4$ в экспоненте:
  существует derivation глубины $3d+O(1)$ размера
  $$\\mathrm{poly}(|T|)\\cdot 2^{X^{4/d}}.$$
  Следовательно, по Theorem 26 (GIRS’19) можно взять ту же константу $c=4$ в форме Thm. 19:
  $$\\mathrm{poly}(|T|)\\cdot 2^{(10\\Delta(G)^2\\mathrm{tw}(G))^{4/d}}.$$
- `Доказательство:` фиксируем явные константы, скрытые в Claim 28 (GIRS’19, p. 13–14).
  Пусть $t_1=\\dots=t_d:=\\lceil X^{2/d}\\rceil$ и $Q$ — $(3,t_1,\\dots,t_d)$‑refinement, как в доказательстве Thm. 27.
  Положим $M:=|\\Phi^1(\\varnothing,Q)|$ (компактное представление паритета).
  1) По Lemma 21 (GIRS’19) имеем
     $$M\\le 48\\cdot\\prod_{i=1}^d 2^{t_i+1}t_i.$$
  2) В Claim 28 крупнейшие поддеривации — это применения Lemma 25; после фиксации константы $21$ в Lemma 24/25 (см. §16.118)
     получаем размер $\\le 21k\\,M^6$ (для $k\\le (\\Delta+1)\\mathrm{tpw}$), а вклад Lemma 22 ($\\le 4M^3$) и Lemma 4
     (для перехода CNF‑паритетов к $\\Phi$‑представлениям) полиномиален в $|T|$ и $M^6$.
     Поэтому вся конструкция Thm. 27 даёт оценку вида
     $$\\mathrm{size}\\le \\mathrm{poly}(|T|)\\cdot M^6.$$
  3) Так как $t_i\\ge 1$, множители $t_i^6$ можно поглотить в $\\mathrm{poly}(|T|)$ (при наших $t_i$ это $\\le (2^dX^2)^{O(1)}$,
     а из $X^{1/d}\\ge 2d$ следует $X\\ge 2^d$). Отсюда
     $$M^6\\le \\mathrm{poly}(|T|)\\cdot 2^{6\\sum_{i=1}^d t_i}.$$
  4) При $t_i=\\lceil X^{2/d}\\rceil$ имеем $\\sum_i t_i\\le d(X^{2/d}+1)\\le 2dX^{2/d}$.
     Из условия $X^{1/d}\\ge 2d$ получаем $2dX^{2/d}\\le X^{3/d}$, значит
     $$6\\sum_i t_i\\le 6X^{3/d}.$$
     Наконец, из $X^{1/d}\\ge 6$ следует $6X^{3/d}\\le X^{4/d}$, то есть $M^6\\le \\mathrm{poly}(|T|)\\cdot 2^{X^{4/d}}$.
  Комбинируя (2)–(4), получаем требуемую явную форму для Thm. 27; подстановка $\\mathrm{tpw}(G)\\le 10\\Delta(G)\\mathrm{tw}(G)$
  (Theorem 26) даёт явную форму Thm. 19.
- `Toy‑тест:` для grid $n\\times n$ имеем $X=\\Delta\\,\\mathrm{tpw}=\\Theta(n)$.
  Если пытаться получить polynomial‑size из формулы $2^{X^{4/d}}$, то естественно взять $d\\asymp 4\\log n/\\log\\log n$, чтобы $X^{4/d}=\\Theta(\\log n)$.
  Но при таком $d$ условие леммы **не выполняется**:
  $$X^{1/d}=\\exp(\\tfrac{\\log X}{d})=\\exp\\!\\left(\\tfrac14\\log\\log n+o(1)\\right)=(\\log n)^{1/4+o(1)}\\ll 2d=\\Theta(\\tfrac{\\log n}{\\log\\log n}).$$
  Следовательно, §16.119 фиксирует явную константу лишь в режиме $d$ “не слишком большой” (когда $X^{1/d}\\ge 2d$), но не даёт polynomial‑size при $d=\\Theta(\\log n/\\log\\log n)$.
- `Статус:` доказано (условная явная константа; **не** закрывает Q39 без снятия условия).
- `Барьер‑чек:` r — неприменимо (верхняя оценка в ограниченной модели доказательств), NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` см. §16.120: записать unconditional upper из Claim 28 и оценить, какой глубины он реально требует для polynomial‑size.

### 16.120. Исследовательский шаг: GIRS’19 upper bound даёт polynomial‑size лишь при глубине $\\Theta(\\log n)$ (а при $\\Theta(\\log n/\\log\\log n)$ — только quasi‑poly)

- `Линза:` Трейд‑офф.
- `Утверждение:` Пусть $G$ — связный граф, $T:=\\mathrm{Tseitin}(G,f)$ невыполнима, $d\\ge 1$ и $X:=\\Delta(G)\\,\\mathrm{tpw}(G)$.
  Тогда из доказательства GIRS’19 Thm. 27/Claim 28 следует upper
  $$\\mathrm{size}(T\\vdash\\bot)\\ \\le\\ \\mathrm{poly}(|T|)\\cdot 2^{\\,O\\bigl(d\\cdot X^{2/d}\\bigr)}.$$
  Для grid $n\\times n$ (где $X=\\Theta(n)$ и число переменных $N=\\Theta(n^2)$) это означает:
  1) при глубине $d=\\Theta(\\log n/\\log\\log n)$ гарантируется лишь $\\mathrm{size}=2^{(\\log n)^{\\omega(1)}}$ (quasi‑poly), а
  2) чтобы из этой оценки получить polynomial‑size, достаточно и по сути необходимо взять $d=\\Theta(\\log n)=\\Theta(\\log N)$.
- `Доказательство:`
  1) Формула $\\mathrm{poly}(|T|)\\cdot 2^{O(d\\cdot X^{2/d})}$ — это §16.115 (полученная непосредственно из Claim 28 и выбора $t_i=X^{2/d}$).
  2) Пусть $L:=\\log X$ и положим $f(d):=d\\cdot X^{2/d}=d\\,\\exp(2L/d)$.
     Если $d=\\alpha\\,L/\\log L$, то $X^{2/d}=\\exp(2L/d)=\\exp(2\\log L/\\alpha)=L^{2/\\alpha}$ и потому
     $$f(d)=\\Theta\\!\\left(\\frac{L}{\\log L}\\cdot L^{2/\\alpha}\\right)=\\Theta\\!\\left(\\frac{L^{1+2/\\alpha}}{\\log L}\\right)=\\omega(L).$$
     Значит экспонента в $2^{O(f(d))}$ строго больше $\\Theta(\\log X)$, и гарантированно polynomial‑size не следует.
  3) Если $d=\\Theta(L)$, то $X^{2/d}=\\exp(\\Theta(1))=\\Theta(1)$ и потому $f(d)=\\Theta(L)$; следовательно
     $2^{O(f(d))}=2^{\\Theta(\\log X)}=\\mathrm{poly}(X)$.
     Для grid $X=\\Theta(n)$ это даёт polynomial‑size при $d=\\Theta(\\log n)=\\Theta(\\log N)$.
- `Toy‑тест:` при $d=\\log X$ имеем $X^{2/d}=X^{2/\\log X}=\\exp(2)$ и экспонента $\\asymp e^2\\log X$; при $d=\\log X/\\log\\log X$
  имеем $X^{2/d}=(\\log X)^2$ и экспонента $\\asymp (\\log X)^3/\\log\\log X$.
- `Статус:` доказано (объясняет, почему «59 vs $c$» из Q39 не закрывается через текущий GIRS‑upper).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` искать другой upper‑аргумент (не через “refinement‑parity” в стиле §16.115), который даёт polynomial‑size уже при глубине $O(\\log n/\\log\\log n)$, или явный барьер для такого улучшения в Frege без XOR‑гейтов.

### 16.121. Исследовательский шаг: оптимизация $f(d)=d\\,X^{2/d}$ (в рамках Claim 28) ⇒ сертификат polynomial‑size требует $d=\\Omega(\\log X)$

- `Линза:` Трейд‑офф.
- `Утверждение:` Пусть $X\\ge 2$ и $f(d):=d\\,X^{2/d}$ для $d>0$ (реальное).
  Тогда:
  1) (**Нижняя граница для сертификата polynomial‑size.**) Если $d=o(\\log X)$, то $f(d)=\\omega(\\log X)$, а значит из upper вида
     $\\mathrm{poly}(|T|)\\cdot 2^{O(f(d))}$ нельзя вывести polynomial‑size.
  2) (**Оптимальный выбор внутри этой оценки.**) $f$ минимальна при $d=2\\ln X$, и $\\min f(d)=2e\\ln X=\\Theta(\\log X)$.
     В частности, bound из Claim 28 действительно даёт polynomial‑size при глубине $d=\\Theta(\\log X)$ (но не при $o(\\log X)$).
- `Доказательство:`
  Запишем $X^{2/d}=\\exp(2\\ln X/d)$ и положим $t:=2\\ln X/d$ (так что $d=2\\ln X/t$). Тогда
  $$\\frac{f(d)}{\\ln X}=\\frac{2\\exp(t)}{t}.$$
  1) Если $d=o(\\log X)$, то $t=2\\ln X/d\\to\\infty$, а потому $\\exp(t)/t\\to\\infty$, то есть $f(d)/\\ln X\\to\\infty$ и $f(d)=\\omega(\\log X)$.
  2) Производная $f'(d)=\\exp(2\\ln X/d)\\cdot(1-2\\ln X/d)$, поэтому минимум достигается при $d=2\\ln X$ и равен
     $f(2\\ln X)=2\\ln X\\cdot \\exp(1)=2e\\ln X$.
- `Toy‑тест:` если $X=2^{64}$, то $\\ln X\\approx 44.36$ и оптимум при $d\\approx 88.7$, где $f(d)\\approx 2e\\ln X\\approx 241$ (экспонента $2^{O(241)}$ — полином от $X$).
- `Статус:` доказано (локальный «барьер техники»: Claim‑28‑upper сам по себе не даёт polynomial‑size при $d=o(\\log X)$).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` для Q39 искать upper‑источник/приём, где верхняя оценка имеет вид $2^{O(X^{c/d})}$ без дополнительного множителя $d$ в экспоненте (или объяснить, почему такой приём невозможен в Frege без XOR‑гейтов).

### 16.122. Исследовательский шаг: «Gaussian elimination» как (пока) отсутствующий upper‑шаг для bounded‑depth Frege на grid

- `Линза:` Эквивалентность.
- `Утверждение:` В Håstad–Risse (2022/2025) §1.2 (`../../resources/downloads/hastad_risse_2022_tseitin_grid_revisited.pdf`)
  явным образом выделен «потенциальный» путь к upper bound для Tseitin(Grid) в bounded‑depth Frege:
  пытаться симулировать суммирование линейных уравнений (Gaussian elimination по модулю 2) в языке формул глубины $d$.
  Авторы показывают, как **представлять** промежуточные паритетные уравнения в виде небольших depth‑$d$ формул,
  но подчёркивают, что **не знают**, как синтаксически переводить один шаг Gaussian elimination в ограниченное число шагов доказательства,
  т.е. получают «representation of partial results», а не proof.
- `Доказательство/ссылка:` Håstad–Risse, §1.2 “Constructing small proofs”, особенно абзацы:
  1) «If we are allowed to reason with linear equations modulo two … efficient refutations …» (идея сложить уравнения по колонкам, ширина $O(n)$);
  2) «We do not know how to syntactically translate a Gaussian elimination step … thus we do not actually get a proof …» (прямая формулировка отсутствующего шага).
- `Toy‑тест:` пусть максимальный размер строки $M=n^{O(1)}$, тогда $\\log M=\\Theta(\\log n)$.
  Формула глубины $d$ размера $M$ может кодировать паритет на $m:=(\\log M)^{d-1}$ переменных.
  При $d=\\Theta(\\log n/\\log\\log n)$ имеем $m=\\exp(\\Theta(\\log n))=n^{\\Theta(1)}\\ge n$, т.е. представление паритета на $n$ переменных возможно при polynomial $M$;
  остаётся ровно «нехватающий» шаг: вывести из таких представлений следующее XOR‑уравнение внутри Frege.
- `Статус:` известный факт (точная ссылка; формализует, где именно ломается наивный upper‑подход).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` формализовать как лемму‑цель: «в bounded‑depth Frege можно (p‑)выводить представление $L_1\\oplus L_2=b_1\\oplus b_2$ из представлений $L_1=b_1$ и $L_2=b_2$ с контролем по глубине/размеру», либо найти источник, где это уже сделано.

### 16.123. Исследовательский шаг: исправление про «representation PARITY» — наивная DNF‑индукция даёт $M^{\\Theta(d)}$, а нужный факт явно заявлен в Håstad–Risse §1.2

- `Линза:` Трейд‑офф.
- `Утверждение:` Рассмотрим утверждение из §16.122: «формулы глубины $d$ размера $M$ могут представлять паритет на $m:=(\\log M)^{d-1}$ переменных».
  1) Наивная конструкция через DNF‑разложение $\\mathrm{PARITY}_{\\lceil\\log_2 M\\rceil}$ и подстановку по глубине действительно даёт depth $O(d)$, но лишь размер $M^{\\Theta(d)}$,
     поэтому **не** выводит polynomial‑size для $d=\\Theta(\\log n/\\log\\log n)$ при $M=\\mathrm{poly}(n)$ (получается quasi‑poly).
  2) Сам «representation»‑факт в нужной (для Q39) форме **известен** и прямо сформулирован в Håstad–Risse (`../../resources/downloads/hastad_risse_2022_tseitin_grid_revisited.pdf`, §1.2):
     они утверждают, что при группировке по блокам размера $(\\log M)^{d-1}$ можно «write down formulas of depth $d$ and size $M$ that represent the parity and the negation of the parity».
- `Доказательство/ссылка:`
  1) (Почему DNF‑индукция не годится при растущей $d$.) Пусть $g:=\\lceil\\log_2 M\\rceil$ и $m:=g^{d-1}$.
     База $d=2$: DNF для $\\mathrm{PARITY}_g$ имеет $2^{g-1}$ термов, т.е. размер $\\Theta(2^g\\cdot g)=\\Theta(M\\log M)$.
     Шаг $d\\to d+1$: подстановка формулы размера $S_d$ в каждое вхождение переменной в этой DNF даёт
     $$S_{d+1}=\\Theta(2^g\\cdot g\\cdot S_d)=\\Theta(M\\log M\\cdot S_d),$$
     откуда $S_d=(M\\log M)^{\\Theta(d)}=M^{\\Theta(d)}$ (лог‑факторы поглощаются в $M^{o(d)}$).
     При $M=n^C$ и $d=\\Theta(\\log n/\\log\\log n)$ это даёт $S_d=n^{\\Theta(\\log n/\\log\\log n)}$ (quasi‑poly), а не $n^{O(1)}$.
  2) (Корректный источник representation.) Håstad–Risse, §1.2, абзац начиная с “Let us consider proofs that contain formulas of depth d …”:
     “… divide the variables in to groups of size $(\\log M)^{d−1}$ and write down formulas of depth $d$ and size $M$ that represent the parity and the negation of the parity …”.
- `Toy‑тест:` возьмём $M=n^{10}$ и $d=\\lfloor\\log n/\\log\\log n\\rfloor$. Тогда $m=(\\Theta(\\log n))^{\\Theta(\\log n/\\log\\log n)}=n^{\\Theta(1)}$,
  и representation из Håstad–Risse допускает формулы размера $M=\\mathrm{poly}(n)$; но DNF‑индукция выше дала бы только quasi‑poly размер.
- `Статус:` контрпример к прежнему выводу «DNF‑индукция ⇒ poly‑size при $d=\\Theta(\\log n/\\log\\log n)$»; representation‑лемма закрыта точной ссылкой (Håstad–Risse §1.2).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` теперь, когда representation опирается на источник, вернуть фокус на missing step из §16.122: найти/доказать (или барьерно опровергнуть) синтаксическую симуляцию одного шага $L_1=b_1,\\ L_2=b_2\\Rightarrow L_1\\oplus L_2=b_1\\oplus b_2$ в bounded‑depth Frege без экспоненциального blow‑up.

### 16.124. Исследовательский шаг: на пороге $d\\approx\\log n/\\log\\log n$ representation XOR‑уравнения ширины $O(n)$ становится константной; Q39 сводится к 1‑шаговой XOR‑симуляции

- `Линза:` Трейд‑офф.
- `Утверждение:` Пусть $n\\to\\infty$, $M=n^{O(1)}$ и $d:=\\lceil\\log_2 n/\\log_2\\log_2 n\\rceil+1$.
  Тогда $(\\log_2 M)^{d-1}\\ge n$, а значит (в терминах §16.122–§16.123) паритетное уравнение на $m=O(n)$ переменных можно представлять **как один блок**:
  в bounded‑depth Frege линии «$\\sum x_i=b$» и «$\\neg(\\sum x_i=b)$» допускают depth‑$d$ формулы размера $\\mathrm{poly}(n)$, и representation‑overhead $2^{m/(\\log M)^{d-1}}$ становится $2^{O(1)}$.
  Следовательно, потенциальный upper‑подход через Gaussian elimination на grid (ширина каждого промежуточного уравнения $O(n)$ и $O(n)$ шагов) упирается не в представимость уравнений, а только в возможность синтаксически симулировать **один** шаг $L_1=b_1,\\ L_2=b_2\\Rightarrow L_1\\oplus L_2=b_1\\oplus b_2$ в bounded‑depth Frege.
- `Доказательство:` так как $M=n^{O(1)}$, существует константа $C\\ge 1$ такая, что $\\log_2 M\\ge C\\log_2 n\\ge \\log_2 n$ для больших $n$.
  По определению $d$ имеем $d-1\\ge \\log_2 n/\\log_2\\log_2 n$.
  Тогда
  $$(\\log_2 M)^{d-1}\\ \\ge\\ (\\log_2 n)^{\\log_2 n/\\log_2\\log_2 n}\\ =\\ 2^{(\\log_2 n/\\log_2\\log_2 n)\\cdot\\log_2\\log_2 n}\\ =\\ 2^{\\log_2 n}\\ =\\ n.$$
  Подстановка в счёт $2^{m/(\\log M)^{d-1}}$ даёт $2^{O(n)/\\Omega(n)}=2^{O(1)}$.
- `Toy‑тест:` пусть $n=2^{16}$, $M=n^{10}$ и $d=\\lceil 16/4\\rceil+1=5$.
  Тогда $\\log_2 M=160$ и $(\\log_2 M)^{d-1}=160^4>10^8\\gg n$, так что $m=n$ попадает в один блок.
- `Статус:` доказано (количественная редукция Q39: на пороговой глубине representation‑стоимость константна).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` искать/формализовать либо (i) p‑выводимость правила XOR‑сложения двух уравнений в bounded‑depth Frege с контролем по глубине/размеру, либо (ii) известный lower‑bound/барьер, запрещающий такое правило при $d=\\Theta(\\log n/\\log\\log n)$.

### 16.125. Исследовательский шаг: формальная редукция Q39 к p‑выводимости одного XOR‑шага (Gaussian elimination) в bounded‑depth Frege

- `Линза:` Эквивалентность.
- `Утверждение:` Зафиксируем $n\\to\\infty$, пусть $G$ — $n\\times n$ grid, а $F_n=\\mathrm{TseitinCNF}(G,\\chi)$ (с $\\bigoplus_v\\chi(v)=1$) — 3‑CNF из §16.85.
  Предположим, что для каждого $m=O(n)$ существует uniform family depth‑$d(n)$ Frege‑выводов полиномиального размера для следующего «XOR‑шага»:
  из двух представлений линейных уравнений по модулю 2,
  $$E(S_1,b_1),\\ E(S_2,b_2)\\ \\vdash\\ E(S_1\\triangle S_2,\\ b_1\\oplus b_2),$$
  где $S_i$ — множества переменных $\\{x_e\\}$ размера $\\le m$, $\\triangle$ — симм. разность, а каждое $E(S,b)$ записано depth‑$d(n)$ формулой размера $\\mathrm{poly}(n)$ (representation из §16.123–§16.124).
  Тогда существует polynomial‑size depth‑$O(d(n))$ Frege‑рефутация $F_n$.
- `Доказательство:` возьмём линейно‑алгебраическую стратегию из Håstad–Risse §1.2:
  (i) суммирование всех уравнений одной колонки даёт уравнение ширины $O(n)$; (ii) прибавление соседней колонки сохраняет ширину $O(n)$;
  (iii) после прохода по всем колонкам получается противоречие $0=1$, и нигде не используется уравнение шире $O(n)$.
  Стандартная 3‑CNF кодировка вершины (4 клаузы для степени 3/4) имеет константный Frege‑вывод эквивалентной XOR‑формулы
  $(\\bigoplus_{e\\ni v} x_e)\\leftrightarrow\\chi(v)$ (см. схему в §16.88), так что мы можем начать с representation всех вершинных уравнений.
  Далее каждый линейный шаг суммирования/сокращения общих переменных — это ровно применение указанного XOR‑правила к двум уравнениям ширины $O(n)$,
  причём по §16.124 каждое промежуточное уравнение можно держать одним representation‑блоком (size $\\mathrm{poly}(n)$, depth $d(n)$).
  Число линейных шагов полиномиально (можно суммировать вершины по очереди внутри колонки и затем колонки по очереди), а каждая подстановка XOR‑правила имеет размер $\\mathrm{poly}(n)$ по предположению,
  значит суммарный размер Frege‑рефутации остаётся $\\mathrm{poly}(n)$ (а значит $\\mathrm{poly}(|F_n|)$).
- `Toy‑тест:` при $n=4$ суммирование 4 вершин одной колонки убивает внутренние вертикальные рёбра (каждое появляется дважды) и оставляет только рёбра, пересекающие границу колонки;
  ширина остаётся $O(n)$, и этот шаблон повторяется при добавлении следующей колонки.
- `Статус:` доказано (условная редукция: закрытие Q39 эквивалентно наличию poly‑size bounded‑depth симуляции одного Gaussian‑elimination шага на XOR‑уравнениях ширины $O(n)$).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` найти точный источник/результат про (не)существование такого XOR‑правила в bounded‑depth Frege (возможно через известные lower bounds для AC$^0$‑Frege на «линейно‑алгебраических» тавтологиях).

### 16.126. Исследовательский шаг: «один XOR‑шаг» = Tseitin на 3‑вершинном (мульти)графе

- `Линза:` Эквивалентность.
- `Утверждение:` Зафиксируем множества переменных $S_1,S_2\\subseteq X$ и биты $b_1,b_2\\in\\{0,1\\}$.
  Тогда правило из §16.125
  $$E(S_1,b_1),\\ E(S_2,b_2)\\ \\vdash\\ E(S_1\\triangle S_2,\\ b_1\\oplus b_2)$$
  (где $E(S,b)$ — «XOR‑уравнение по модулю 2» над переменными из $S$) эквивалентно refutation’у Tseitin‑противоречия на графе из трёх вершин, в котором каждое ребро соответствует одной переменной из $X$.
- `Доказательство:`
  1) (**Граф.**) Построим мультиграф $H(S_1,S_2)$ с вершинами $A,B,C$ и рёбрами:
     - для каждого $x\\in S_1\\cap S_2$ добавим ребро $(A,B)$, помеченное $x$;
     - для каждого $x\\in S_1\\setminus S_2$ добавим ребро $(A,C)$, помеченное $x$;
     - для каждого $x\\in S_2\\setminus S_1$ добавим ребро $(B,C)$, помеченное $x$.
     Тогда инцидентные $A$ рёбра — ровно переменные из $S_1$, инцидентные $B$ — из $S_2$, а инцидентные $C$ — из $S_1\\triangle S_2$.
  2) (**Tseitin‑система.**) Положим заряды $\\chi(A)=b_1$, $\\chi(B)=b_2$, $\\chi(C)=1\\oplus b_1\\oplus b_2$.
     Тогда Tseitin($H,\\chi$) есть система трёх XOR‑уравнений
     $$E(S_1,b_1),\\quad E(S_2,b_2),\\quad E(S_1\\triangle S_2,\\ 1\\oplus b_1\\oplus b_2).$$
     Поскольку $b_1\\oplus b_2\\oplus(1\\oplus b_1\\oplus b_2)=1$, сумма зарядов нечётна, и по инварианту из §16.85 система невыполнима.
  3) (**Импликация ↔ refutation.**) Невыполнимость тройки уравнений равносильна тавтологии
     $$E(S_1,b_1)\\wedge E(S_2,b_2)\\ \\to\\ \\neg E(S_1\\triangle S_2,\\ 1\\oplus b_1\\oplus b_2).$$
     Но $\\neg E(S,1\\oplus b)$ тождественно $E(S,b)$, значит это ровно $E(S_1,b_1)\\wedge E(S_2,b_2)\\to E(S_1\\triangle S_2,b_1\\oplus b_2)$.
     Поэтому polynomial‑size bounded‑depth Frege refutation Tseitin($H,\\chi$) (при фиксированном способе записи $E$) даёт polynomial‑size bounded‑depth доказательство XOR‑шага и наоборот (с точностью до $O(1)$ по глубине).
- `Toy‑тест:` если $S_1=\\{x,y\\}$, $S_2=\\{y,z\\}$, то рёбра: $y$ между $(A,B)$, $x$ между $(A,C)$, $z$ между $(B,C)$.
  Уравнения: $x\\oplus y=b_1$, $y\\oplus z=b_2$, $x\\oplus z=1\\oplus b_1\\oplus b_2$ — явное противоречие.
- `Статус:` доказано (переформулировка «missing step» как частного Tseitin).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` искать (не)известные оценки на bounded‑depth Frege для этой 3‑вершинной Tseitin‑семьи при ширине $|S_1|,|S_2|=\\Theta(n)$ и глубине $d=\\Theta(\\log n/\\log\\log n)$ (это и есть «один Gaussian‑elimination шаг»).

### 16.127. Исследовательский шаг: XOR‑сложение уравнений тривиально в EF, но перевод в bounded‑depth Frege даёт лишь $O(\\log n)$ по глубине

- `Линза:` Трейд‑офф.
- `Утверждение:` Семейство «одного XOR‑шага» (эквивалентное 3‑вершинному Tseitin из §16.126) имеет polynomial‑size refutation в Extended Frege (EF),
  поскольку EF может вводить abbreviation‑переменные и симулировать Gaussian elimination. Однако стандартные приёмы перевода/балансировки дают
  для обычного Frege только верхнюю оценку глубины $O(\\log n)$ (а не $O(\\log n/\\log\\log n)$), так что это не закрывает Q39.
- `Доказательство/пояснение:`
  1) EF‑верхняя оценка: см. §16.88 (каркас EF‑доказательства Tseitin через XOR‑переменные) и замечание «EF легко симулирует Gaussian elimination»
     (Bonet–Buss–Pitassi 2002, `../../resources/downloads/bonet_buss_pitassi_2002_hard_examples_frege.pdf`, p. 7).
     Для 3‑вершинного Tseitin (и вообще для линейных систем над $\\mathbb F_2$) EF может хранить промежуточные XOR‑уравнения в extension‑переменных и выполнять шаги сложения строк.
  2) Переход к bounded‑depth Frege: даже если есть polynomial‑size (E)Frege‑доказательство, известная универсальная балансировка формул (Spira/Brent) даёт глубину лишь
     $O(\\log m)$ для формул размера $m$ (см. §16.94), а в нашем режиме $m=\\mathrm{poly}(n)$ это $O(\\log n)$.
     Именно поэтому «есть EF‑доказательство Gaussian elimination» не означает «есть depth‑$\\Theta(\\log n/\\log\\log n)$ Frege‑доказательство одного XOR‑шага».
- `Toy‑тест:` для паритета на $n$ переменных балансировка даёт глубину $O(\\log n)$ для явной XOR‑деревянной формулы, но Q39 требует глубину порядка $\\log n/\\log\\log n$.
- `Статус:` доказано (локальный барьер: стандартный EF→Frege+балансировка не даёт нужной глубины).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` искать технику, которая уменьшает глубину вывода XOR‑шага ниже $O(\\log n)$ (например, через специальные depth‑$d$ представления паритета из Håstad–Risse и доказательства их линейности), либо источник, что такой сдвиг невозможен.

### 16.128. Исследовательский шаг: Claim‑28 upper (GIRS’19) не сертифицирует polynomial‑size даже для «локального» 3‑вершинного Tseitin при $d\\approx\\log n/\\log\\log n$

- `Линза:` Трейд‑офф.
- `Утверждение:` Рассмотрим семейство 3‑вершинных Tseitin‑противоречий из §16.126, где $|S_1|,|S_2|=\\Theta(n)$ (значит число переменных $\\Theta(n)$).
  Тогда общий upper bound из GIRS’19 (Claim 28 → Thm. 27; см. §16.115–§16.121) гарантирует polynomial‑size refutation лишь при глубине
  $$d=\\Omega(\\log n),$$
  и потому не может закрыть Q39 в режиме $d=\\Theta(\\log n/\\log\\log n)$ даже на одном Gaussian‑elimination шаге.
- `Доказательство:` пусть $H=H(S_1,S_2)$ — мультиграф на вершинах $A,B,C$ из §16.126.
  1) $\\Delta(H)=\\max\\{|S_1|,|S_2|,|S_1\\triangle S_2|\\}=\\Theta(n)$.
  2) По определению tree‑partition width из GIRS’19 §4.3 можно взять одно множество $\\{A,B,C\\}$ как единственную часть tree‑partition, значит
     $$\\mathrm{tpw}(H)\\le 3.$$
     Следовательно, $X:=\\Delta(H)\\,\\mathrm{tpw}(H)=\\Theta(n)$.
  3) Применяя явный unconditional upper из §16.120,
     $$\\mathrm{size}\\le \\mathrm{poly}(|T|)\\cdot 2^{O\\bigl(d\\cdot X^{2/d}\\bigr)},$$
     и лемму‑оптимизацию §16.121 (polynomial‑size возможно только при $d=\\Omega(\\log X)$), получаем требование $d=\\Omega(\\log n)$.
- `Toy‑тест:` если $d=\\lfloor\\log n/\\log\\log n\\rfloor$, то $X^{2/d}=\\exp(2\\log n/d)=(\\log n)^{\\Theta(1)}$ и
  $$2^{O(d\\cdot X^{2/d})}=2^{\\mathrm{polylog}(n)}=n^{\\mathrm{polylog}(n)}$$
  (quasi‑poly), а не $n^{O(1)}$.
- `Статус:` доказано (локальный «барьер техники»: tree‑partition upper из GIRS’19 не достигает пороговой глубины даже для 3‑вершинного шага).
- `Барьер‑чек:` r — неприменимо, NP — неприменимо, alg — неприменимо.
- `Следующий шаг:` искать приём, который использует специальную структуру grid/representation (Håstad–Risse) и обходится без параметра $X=\\Delta\\,\\mathrm{tpw}$ (или доказать, что для 3‑вершинного Tseitin при $d=\\Theta(\\log n/\\log\\log n)$ неизбежна quasi‑poly нижняя оценка).
