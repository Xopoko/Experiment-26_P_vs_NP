# Q39.S158 nonrelativizing gadget plan (barrier note)
Goal: sketch how to append an oracle-specific gadget to the contiguous, orbit-based shift so that the rank-2 witness can no longer be produced by arithmetic/log2 maps alone; the gadget should tie the next shift to the oracle so that Bakers-Gill-Solovay/Katz-style relativization and Algebrization barriers remain the obstruction unless the gadget can be neutralized.
Dependencies: `docs/q39_s157.md`, `formal/WIP/Verified/Q39.lean`, `scripts/toy_q39_rank2.py`.
Exact citations:
- Baker, Gill, Solovay (1975), *Relativizations of the P = ? NP Question* (Thm. 1, p.15) — any gadget that remains oracle-agnostic keeps the contiguous shift entirely relativizing, so a nonrelativizing feature is required for progress.
- Katz (2005), *Relativizing the P vs. NP Question* (Claim 1, p.1) — continuing oracle-augmented XOR sequences preserves rank-2 witnesses, so the fresh gadget must break that preservation.
- Aaronson, Wigderson (2008), *Algebrization: A New Barrier in Complexity Theory* (Thm. 5.3, p.23) — algebraic extensions see the same XOR arithmetic, so the gadget must inject oracle-specific data that defies algebraic extension symmetry.
Notes:
- The contiguous shifts so far only changed the bitvectors along a fixed orientation thus remaining in the same arithmetic orbit; adding a gadget means encoding a global support bit that depends on the oracle or per-instance advice so that any future shift requires oracle knowledge to reproduce.
- We plan to attach the gadget to the contiguous block by consulting an oracle-specific flag (e.g., a global XOR parity tied to the oracle) before computing the next alt shift, and then show `scripts/toy_q39_rank2.py` still reports rank 2 unless the gadget is removed.
- The implementation plan is recorded in `docs/q39_s159.md`, where the gadget is concretely tied to oracle/advice data.
- Next step: once the gadget is defined, run the toy/oracle to check whether the rank-2 witness survives, and once the entropy-stopper policy allows another attempt, restart the contiguous sequence with the gadget present.
BarrierCheck:
- Relativization:
  - Relativizes?: unknown (the gadget deliberately introduces oracle-specific control).
  - If no: the gadget depends on the oracle/advise string, so the shift will not survive arbitrary oracle substitutions.
  - Exit point: the gadget must rely on an oracle-aware parameter (global support bit or advice index) to escape the relativizing chain.
- NaturalProofs:
  - Applicable?: no (the barrier is about translation invariants, not density/constructivity).
- Algebrization:
  - Applicable?: yes (AW08 ensures algebraic extensions keep the XOR arithmetic if no oracle-specific bits exist); the gadget must break that symmetry too.
- Citations: [BGS75], [Katz05], [AW08]
