## 10. Полная нижняя оценка в глубине 2: PARITY

Определим $\mathrm{PARITY}_n(x_1,\dots,x_n)=x_1\oplus\cdots\oplus x_n$.
Значение 1 тогда и только тогда, когда число единиц нечётно.

**Определение (терм).** Терм $T$ — конъюнкция литералов, в которой каждая
переменная встречается не более одного раза: $T=\bigwedge_{i\in S} \ell_i$,
где $\ell_i\in\{x_i,\neg x_i\}$.
Множество входов, удовлетворяющих $T$, — подкуб, полученный фиксацией
переменных из $S$.

**Лемма 10.1.** Если терм $T$ не фиксирует хотя бы одну переменную
(то есть $S\ne\{1,\dots,n\}$), то на множестве входов, удовлетворяющих $T$,
функция $\mathrm{PARITY}_n$ не является константой.

*Доказательство.* Пусть $j\notin S$ — свободная переменная.
Возьмём любой вход $a$, удовлетворяющий $T$, и вход $a'$, полученный из $a$
инверсией только $x_j$. Тогда $a'$ тоже удовлетворяет $T$,
но $\mathrm{PARITY}_n(a')=1-\mathrm{PARITY}_n(a)$ (меняется ровно один бит).
Значит, на $T^{-1}(1)$ значения паритета не константны. $\square$

**Лемма 10.2.** Для $n\ge 1$ множество $\mathrm{PARITY}_n^{-1}(1)$ имеет размер $2^{n-1}$.

*Доказательство.* Отображение $\phi(x_1,\dots,x_n)=(1-x_1,x_2,\dots,x_n)$ —
биекция на $\{0,1\}^n$, которая меняет паритет (переворачивает ровно один бит).
Значит она взаимно-однозначно сопоставляет входы с паритетом 0 и 1;
а всего входов $2^n$, следовательно, каждого вида ровно $2^{n-1}$. $\square$

**Теорема 10.3.** Любая DNF‑формула, вычисляющая $\mathrm{PARITY}_n$, содержит
как минимум $2^{n-1}$ термов. Аналогично, любая CNF‑формула для
$\mathrm{PARITY}_n$ содержит как минимум $2^{n-1}$ клауз.

*Доказательство (DNF).* Пусть $F=\bigvee_{r=1}^m T_r$ — DNF, вычисляющая
$\mathrm{PARITY}_n$. Для любого $r$ множество $T_r^{-1}(1)$ должно лежать внутри
$\mathrm{PARITY}_n^{-1}(1)$, иначе существовал бы вход, где $T_r=1$ но паритет 0,
и тогда $F$ ошибается.

По Лемме 10.1 это возможно лишь если каждый $T_r$ фиксирует все переменные,
то есть $T_r^{-1}(1)$ состоит ровно из одного входа (минтерм).

Значит каждый терм покрывает не более одного входа из $\mathrm{PARITY}_n^{-1}(1)$.
По Лемме 10.2 таких входов $2^{n-1}$, следовательно $m\ge 2^{n-1}$.

*Доказательство (CNF).* Если $G$ — CNF для $\mathrm{PARITY}_n$, то $\neg G$ —
DNF для $\neg\mathrm{PARITY}_n$ (проталкиваем отрицания и применяем де Моргана).
Поскольку $\neg\mathrm{PARITY}_n$ также имеет ровно $2^{n-1}$ единиц, применяем
DNF‑часть к $\neg\mathrm{PARITY}_n$ и получаем, что $\neg G$ имеет $\ge 2^{n-1}$
термов, а значит $G$ имеет $\ge 2^{n-1}$ клауз.

$\square$
