## 14. Polynomial hierarchy (PH): definitions and basic collapses

The polynomial hierarchy is a "superstructure" over NP/coNP,
resulting from the alternation of quantifiers (or equivalently from oracle machines).

### 14.1. Definitions via Oracles

Recall: in the oracle model, the machine can ask in one step whether a row belongs to the oracle.

**Definition.** Let $\Sigma_0^p=\Pi_0^p:=\mathrm{P}$. For $k\ge 0$ we define recursively:

- $\Sigma_{k+1}^p := \mathrm{NP}^{\Sigma_k^p}$,
- $\Pi_{k+1}^p := \mathrm{coNP}^{\Sigma_k^p}$,
- $\mathrm{PH} := \bigcup_{k\ge 0} \Sigma_k^p$.

**Lemma 14.1.** $\Sigma_1^p=\mathrm{NP}$ and $\Pi_1^p=\mathrm{coNP}$.

*Proof.* By definition, $\Sigma_1^p=\mathrm{NP}^{\Sigma_0^p}=\mathrm{NP}^{\mathrm{P}}$.
Let us show that $\mathrm{NP}^{\mathrm{P}}=\mathrm{NP}$: NP oracle machine
makes polynomially many queries to the oracle from $\mathrm{P}$
and it works in polynomial time.
Each query can be evaluated deterministically in polynomial time
"inside" the same branch of non-deterministic calculation, therefore the total
time remains polynomial; means $\mathrm{NP}^{\mathrm{P}}\subseteq\mathrm{NP}$.
Reverse inclusion is trivial (don't make queries).
Similarly $\Pi_1^p=\mathrm{coNP}^{\mathrm{P}}=\mathrm{coNP}$. $\square$

### 14.2. Quantifier characterization (for further evidence)

Equivalent to oracle determination, PH levels can be set
through a fixed number of alternations of quantifiers over polynomially
verifiable predicate.

**Definition (quantifier form).** A language $L$ belongs to $\Sigma_k^p$ (for $k\ge 1$) if
there is a polynomial $p$ and a deterministic polynomial machine $V$ such that
$$x\in L \iff \exists y_1\in\{0,1\}^{p(|x|)}\ \forall y_2\in\{0,1\}^{p(|x|)}\ \exists y_3\cdots Q_k y_k:\ V(x,y_1,\dots,y_k)=1,$$
where quantifiers alternate and $Q_k$ is equal to $\exists$ for odd $k$
and $\forall$ for even $k$.

Similarly, $L\in\Pi_k^p$ if the formula starts with $\forall$ and then alternates.

**Lemma 14.2.** The quantifier form is equivalent to the oracle determination of PH levels.

*Comment.* This is a standard theorem; detailed proof - Arora-Barak
(sections about PH). Below we use the quantifier form only for
proof of collapse (Theorem 14.4).

### 14.3. Basic facts about collapses

**Theorem 14.3.** If $\mathrm{P}=\mathrm{NP}$, then $\mathrm{PH}=\mathrm{P}$.

*Proof.* Let us prove by induction that for all $k\ge 0$
$\Sigma_k^p=\mathrm{P}$ is satisfied.

Base: $\Sigma_0^p=\mathrm{P}$ by definition.

Transition: let $\Sigma_k^p=\mathrm{P}$. Then
$$\Sigma_{k+1}^p=\mathrm{NP}^{\Sigma_k^p}=\mathrm{NP}^{\mathrm{P}}=\mathrm{NP}.$$
Under the assumption $\mathrm{P}=\mathrm{NP}$ we obtain $\Sigma_{k+1}^p=\mathrm{P}$.
Consequently, all levels are equal to $\mathrm{P}$, and hence $\mathrm{PH}=\mathrm{P}$. $\square$

**Theorem 14.4 (collapse at level $k$, classical).** If for some
$k\ge 1$ is satisfied $\Sigma_k^p=\Pi_k^p$, then $\mathrm{PH}=\Sigma_k^p$.

*Proof.* It is enough to show that $\Sigma_{k+1}^p\subseteq\Sigma_k^p$
and $\Pi_{k+1}^p\subseteq\Sigma_k^p$, after which by induction we obtain the inclusion
all higher levels in $\Sigma_k^p$.

Let's take $L\in\Sigma_{k+1}^p$ and use the quantifier form.
Then there exists a polynomial $p$ and a polynomial predicate $V$ such that
$$x\in L\iff \exists y\in\{0,1\}^{p(|x|)}:\ \Psi(x,y),$$
where $\Psi(x,y)$ is a formula with $k$ alternations starting with $\forall$
(that is, the language $L':=\{\langle x,y\rangle:\ \Psi(x,y)\}$ lies in $\Pi_k^p$).

By the collapse assumption $\Pi_k^p=\Sigma_k^p$, then $L'\in\Sigma_k^p$. Then
$$L=\{x:\ \exists y\ \langle x,y\rangle\in L'\}$$
is an *existential projection* of language from $\Sigma_k^p$. Such a projection
adds one leading quantifier $\exists$, but if $k\ge 1$ then the addition
leading $\exists$ to $\Sigma_k^p$ does not increase the level: it is absorbed
the first quantifier $\exists$ of the already existing $\Sigma_k$formula for $L'$.
(You can combine two existential blocks into one by increasing the polynomial
to the length of the witness.)

Therefore, $L\in\Sigma_k^p$, that is, $\Sigma_{k+1}^p\subseteq\Sigma_k^p$.

Similarly, for $L\in\Pi_{k+1}^p$ we have the representation
$x\in L\iff \forall y\ \Theta(x,y)$, where $\Theta$ specifies the language from $\Sigma_k^p$.
Let's rewrite it as an addition:
$$x\in L\iff \neg\exists y:\ \neg\Theta(x,y).$$
The language $\{\langle x,y\rangle:\ \neg\Theta(x,y)\}$ lies in $\Pi_k^p=\Sigma_k^p$,
and then using the same argument we get $L\in\Pi_k^p=\Sigma_k^p$.

So, the levels $k+1$ (and therefore all higher ones) lie in $\Sigma_k^p$,
and trivially $\Sigma_k^p\subseteq\mathrm{PH}$.
So $\mathrm{PH}=\Sigma_k^p$. $\square$

### 14.4. Karp-Lipton: NP  P/poly  PH collapse

Recall: $\mathrm{P/poly}$ are languages recognized by a family of polynomial-sized Boolean circuits (non-uniform model).

**Lemma 14.5 (search from the SAT solution).** If $\mathrm{SAT}\in\mathrm{P/poly}$,
then there is a family of circuits $\{W_m\}$ of polynomial size that
given the code of a satisfiable SAT formula, $\varphi$ returns a satisfying assignment.

*Proof.* Let $\{C_m\}$ be a family of polynomial-size circuits solving SAT on formulas of length $m$.

We use standard selfreduction: we fix variables one at a time.
For $i=1,\dots,t$ (where $t$ is the number of variables in $\varphi$) we check
satisfiability of the formula with the added fixation $u_i=0$; if feasible -
set $u_i:=0$, otherwise $u_i:=1$.
If $\varphi$ is satisfiable, this process will construct a satisfying assignment
for a polynomial number of SAT calls.

By replacing each SAT call with a $C_m$ circuit and unrolling the sequential
calculations into the circuit, we get $W_m$ of size
$\mathrm{poly}(m)\cdot|C_m|=\mathrm{poly}(m)$. $\square$

**Theorem 14.6 (Karp-Lipton, classical).** If $\mathrm{NP}\subseteq\mathrm{P/poly}$, then $\mathrm{PH}=\Sigma_2^p$.

*Proof.* It is enough to show $\Pi_2^p\subseteq\Sigma_2^p$
and apply Theorem 14.4 for $k=2$.

Let $L\in\Pi_2^p$. According to the quantifier form there is a polynomial
predicate $R$ and polynomial $p$ such that
$$x\in L \iff \forall y\in\{0,1\}^{p(|x|)}\ \exists z\in\{0,1\}^{p(|x|)}:\ R(x,y,z)=1.$$ 

Consider the language
$$A:=\{\langle x,y\rangle:\ \exists z\ R(x,y,z)=1\}.$$ 
Then $A\in\mathrm{NP}$, and therefore, by assumption, $A\in\mathrm{P/poly}$.

According to Cook-Levin (cited, in verifier form) from the relation
$\exists z\ R(x,y,z)$ we can polynomially construct the SAT formula $\varphi_{x,y}$,
such that $\varphi_{x,y}$ is satisfiable if and only if there exists
suitable $z$; and moreover, from any satisfying assignment
$\varphi_{x,y}$ we can extract such $z$ polynomially.

Since $\mathrm{SAT}\in\mathrm{P/poly}$, by Lemma 14.5 there exists
polynomial witness circuit for SAT. Composition
(build $\varphi_{x,y}$ -> witness for $\varphi_{x,y}$ -> extract $z$)
we get: for every fixed $x$ there is a polynomial scheme $W_x$,
which, given input $y$, produces some witness $z=W_x(y)$ satisfying
$R(x,y,z)$, if such exists.

Then
$$x\in L \iff \exists W_x\ \forall y:\ R(x,y,W_x(y))=1,$$
which is the $\Sigma_2^p$ description. Therefore, $\Pi_2^p\subseteq\Sigma_2^p$,
means $\Sigma_2^p=\Pi_2^p$ and by Theorem 14.4 we have
$\mathrm{PH}=\Sigma_2^p$. $\square$
